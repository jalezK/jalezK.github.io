<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-RFC 1644-T:TCP" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/14/RFC%201644-T:TCP/" class="article-date">
  <time class="dt-published" datetime="2022-07-14T11:47:27.842Z" itemprop="datePublished">2022-07-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="RFC-1644"><a href="#RFC-1644" class="headerlink" title="RFC 1644"></a>RFC 1644</h1><p>##1. 介绍</p>
<p>TCP旨在围绕虚拟电路模型，支持数据流。另一种常见的通信模式是客户机-服务器交互，即请求消息后跟响应消息。请求&#x2F;响应范例由实现事务处理或远程过程调用的应用层协议以及许多网络控制和管理协议（例如DNS和SNMP）使用。目前，许多需要请求&#x2F;响应通信的互联网用户程序使用UDP，当它们需要传输协议功能（如可靠交付）时，它们必须在应用层有效地构建自己的专用传输协议。</p>
<p>请求&#x2F;响应或“面向事务”的通信具有以下特点：</p>
<p>（a） 基本交互是一个请求，然后是一个响应。</p>
<p>（b） 明确的打开或关闭阶段可能会带来过多的开销。</p>
<p>（c） 最多需要一次语义；也就是说，不能因为重复的请求数据包而“重播”事务。</p>
<p>（d） 客户端的最小事务延迟应为RTT+SPT，其中RTT是往返时间，SPT是服务器处理时间。</p>
<p>（e） 在有利的情况下，每个方向只有一个数据包，就可以实现可靠的请求&#x2F;响应握手。</p>
<p>本备忘录涉及T&#x2F;TCP，它是TCP的向后兼容扩展，除了虚拟电路服务外，还提供高效的面向事务的服务。TCP提供上述所有功能，除了（e）；T&#x2F;TCP的最小交换是三段。</p>
<p>在本备忘录中，我们使用术语“事务”表示基本的请求&#x2F;响应数据包序列。这并不意味着任何通常与应用层事务处理相关的语义，如3阶段提交。预计T&#x2F;TCP可以用作此类应用层服务的传输层，但T&#x2F;TCP的语义仅限于传输层服务，例如可靠、有序的交付，最多一次操作。</p>
<p>早期的备忘录[RFC-1379]介绍了T&#x2F;TCP中涉及的概念。然而，这些想法在现实世界中的有用性取决于实际问题，如实现的复杂性和性能。为了帮助探索这些问题，本备忘录为RFC-1379中提出的思想的特定实施例提供了功能规范。然而，本备忘录中的特定算法代表了比RFC-1379更晚的进化。特别是，RFC-1379中的附录A解释了截断等待时间状态的困难。然而，后来在工作站上实施RFC-1379算法的经验表明，等待状态下TCB的累积是一个无法容忍的问题；这种必要性导致了一种截断等待时间状态的简单解决方案，如本备忘录所述。</p>
<p>第2节介绍了T&#x2F;TCP扩展，第3节包含了T&#x2F;TCP的完整规范。第4节讨论了一些实现问题，附录A包含算法摘要。本文件假设熟悉标准TCP规范[STD-007]。</p>
<h2 id="2-概述"><a href="#2-概述" class="headerlink" title="2. 概述"></a>2. 概述</h2><p>TCP协议在连接的两端之间高度对称。这种对称性在T&#x2F;TCP中没有丢失；例如，T&#x2F;TCP支持TCP从两侧同时对称打开（以下第2.3节）。然而，事务序列以高度不对称的方式使用T&#x2F;TCP。对于发起连接的主机和响应的主机，分别使用术语“客户端主机”和“服务器主机”是很方便的。</p>
<p>TCP的目标是允许每个事务（即每个请求&#x2F;响应序列）作为TCP连接的单个化身有效地执行。标准TCP为面向事务的通信带来了两个性能问题。首先，通过“三方握手”打开TCP连接，在传输数据之前，必须成功完成握手。三方握手为事务的延迟增加了额外的RTT（往返时间）。</p>
<p>第二个性能问题是，关闭TCP连接会使一端或两端在时间2*MSL内处于等待状态，其中MSL是最大段生存期（定义为120秒）。TIME-WAIT状态严重限制了同一（主机、端口）对之间的连续事务速率，因为在TIME-WAIT延迟过期之前，无法打开新的连接。RFC-1379解释了为什么替代方法（为一对主机之间的每个事务使用不同的用户端口）也会限制事务速率：（1）16位端口空间将速率限制为每秒2**16&#x2F;240个事务，（2）更实际的是，在等待状态下，TCP状态块会占用过多的内核空间[RFC-1379]。<br>TCP通过（1）绕过三路握手（3WH）和（2）缩短等待状态下的延迟，解决了事务的这两个性能问题。</p>
<h3 id="2-1-绕过三方握手"><a href="#2-1-绕过三方握手" class="headerlink" title="2.1 绕过三方握手"></a>2.1 绕过三方握手</h3><p>TCP引入了一个32位的具体数字，称为“连接计数”（CC），它在每个段的TCP选项中携带。为开放连接的每个方向分配一个不同的CC值。TCP实现将单调递增的CC值分配给它主动或被动打开的连续连接。</p>
<p>TCP利用初始<syn>段中CC值的单调性绕过3WH，使用我们称之为TCP加速开放（TAO）的机制。在TAO机制下，主机为每个远程主机缓存少量状态。具体来说，充当服务器的T&#x2F;TCP主机保留一个缓存，其中包含它从每个不同的客户端主机收到的最后一个有效CC值。如果来自特定客户端主机的初始<syn>段（即，包含SYN位但没有ACK位的段）携带的CC值大于相应的缓存值，则CC的单调特性确保<syn>段必须是新的，因此可以立即接受。否则，服务器主机不知道<syn>段是旧的重复段还是只是无序交付；因此，它执行正常的3WHS以验证<syn>。因此，TAO机制提供了一种优化，将正常TCP机制作为后备机制。</p>
<p>非同步段中携带的CC值用于防止旧的重复段受到同一连接早期版本的影响（我们简称这些段为“仿古重复段”）。在短连接（例如事务）的情况下，这些CC值允许在第2.3节中安全地讨论等待状态延迟。</p>
<p>TCP定义了三个新的TCP选项，每个选项都携带一个32位CC值。这些选项名为CC，CC.NEW和CC.ECHO。通常使用CC选项。CC.NEW和CC.ECHO具有以下特殊功能。</p>
<p>a .CC.NEW</p>
<p>TAO机制的正确性要求客户端为连续的连接启动生成单调递增的CC值。这些值可以使用简单的全局计数器生成。当客户知道可能违反单调性时，存在某些情况（下文第2.2节讨论）；在这种情况下，在初始化的<syn>段中发送CC.NEW而不是CC选项。接收CC.NEW会导致服务器使其缓存项无效，并执行3WHS。</p>
<p>b.CC.ECHO</p>
<p>当服务器主机发送一个&lt;syn，ack&gt;段时，它会回显CC.ECHO选项中初始<syn>的连接计数。客户端主机使用该选项验证&lt;syn，ack&gt;段。</p>
<p>图1说明了绕过3WHS的TAO机制。缓存的CC值，由Cache.CC[主机]表示，显示在每一侧。服务器主机将段#1中的新CC值x与x0进行比较，x0是客户端主机A的缓存值；这种比较被称为“TAO 测试”。由于x&gt;x0，<syn>必须是新的，并且可以立即接受；因此，段中的数据可以传递给用户进程B，并更新缓存的值。如果TAO测试失败（x≤x0），服务器主机将执行正常的三方握手以验证<syn>段，但缓存不会更新。</p>
<p>CC值x在[SYN,ACK]段中的CC.ECHO选项（#2）中回显；客户端使用此选项验证段。由于段#2是有效的，其data2被传递到客户端用户进程。段#2也携带B的CC值；这由A用于验证来自B的非同步段。</p>
<p>实现T&#x2F;TCP的扩展，扩展连接控制块（TCB），以包括连接的两个CC值；将这些变量称为TCB.CCsend和TCB.CCrecv（或CCsend，简称CCrecv）。例如，图1所示的序列，在主机A上设置TCB.CCsend&#x3D;x,TCB.CCrecv&#x3D;y在主机B处，反之亦然。使用CC选项接收的任何段包含不同于“TCB.CCsend”的“SEG.CC”值，将被视为赝品拒绝。</p>
<p>![截屏2022-07-14 下午7.32.50](&#x2F;Users&#x2F;sunzekun&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;截屏2022-07-14 下午7.32.50.png)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/14/RFC%201644-T:TCP/" data-id="cl77bm6pn00032kfy3qrdfozc" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CCSDS相关资料" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/06/CCSDS%E7%9B%B8%E5%85%B3%E8%B5%84%E6%96%99/" class="article-date">
  <time class="dt-published" datetime="2022-07-05T17:13:43.968Z" itemprop="datePublished">2022-07-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>#CCSDS相关论文：</p>
<p>##1. [1.2有用Research on E…ssion Systems_康婧.pdf](&#x2F;Users&#x2F;sunzekun&#x2F;Desktop&#x2F;Markdown&#x2F;kk&#x2F;1.2有用Research on E…ssion Systems_康婧.pdf) </p>
<p>目前，LDPC 码已广泛应用于CCSDS 和ETSI 等空间通信标准。CCSDS 标准[6][8]主要包括近地应用7&#x2F;8 LDPC 码；深空通信多码率兼容非规则LDPC 码，上行遥控链路二进制和非二进制超短码。ETSI 制定的第二代数字视频广播标准（The econd Generation Digital Video Broadcast，DVB-S2）[7]采用BCH（Bose-Chaudhuri-Hochquenghem，BCH）为外码、LDPC 为内码的编码，支持多种码率和码长。</p>
<p>2010 年，Hamkins 等对CCSDS 深空通信AR4JA LDPC 码编码调制系统进行了仿真与性能分析[126]。2012 年，Liva 等人基于DVB-S2 标准对高吞吐率译码器进行了研究，旨在提高信道传输速率并支持VCM[127]。同时，Liva 等人也对CCSDS下一代上行链路非二进制1&#x2F;2（128，64）LDPC 超短码的特点进行了研究[128]。2013 年，欧洲航天局进行了DVB-S2 标准验证实验[129]，研究了LDPC 和BCH级联编码以及先进调制技术方案。同年，美国宇航局在IRIS 发射任务中采用了CCSDS 近地卫星通信标准7&#x2F;8 LDPC 码[130]。</p>
<p>2011 年，嫦娥二号探月卫星下行数传链路采用了清华大学开发的LDPC 编译码设备[131]。2016 年，中国科学院国家空间科学中心在实践十号科学实验卫星数传系统中，基于CCSDS 近地卫星通信标准，采用两路并行编码实现了300Mbps的编码速率[97][132]。2019 年，高分七号卫星采用了DVB-S2 标准BCH 和LDPC码级联编码方案，与高阶调制相结合，实现了双通道21.2Gbps的高速数据传输速率[15]。</p>
<p>##2.  [有点用The Research …rated Network_张桐.pdf](&#x2F;Users&#x2F;sunzekun&#x2F;Desktop&#x2F;Markdown&#x2F;kk&#x2F;有点用The Research …rated Network_张桐.pdf) </p>
<p>该标准是由太空数据系统顾问委员会(Consultative Committee for Space Data Systems, CCSDS)率先倡导提出的， 它是一家成立千1982年的国际太空组织， 由包含我国的中国国家航天局在内的11家成员机构， 以及28家观察机构和144 个工业合作伙伴组成。该组织最初为航天器在太空中测控和通信等活动制定了一 套通信标准CCSDS, 经过了20多年的发展， CCSDS已经包含大量的通信协议 和数据处理的标准，实现了国际航天通信的标准化，促进了国际航天机构之间的 合作交流和航天技术的交叉支持， 推动了航天技术的商业化[22] 。CCSDS目前支持的服务包括： 太空互联网服务(Space Intemetworking Services, SIS), 任务操作和信息管理服务(Mission Ops. And Information Management Services, MOIM),宇航器星载接口服务(Spacecraft Onboard Interface Services, SOIS），系统工程(SystemEngineering, SE），交叉支持服务(Cross Support Services, CSS), 太空链路服务(Space Link Services, SLS)。CCSDS最初为了满足太空测控任务的需求，提出了常规在轨系统(COS),后来随着航天通信技术的发展，可以在太空进行语音、数据和多媒体等宽带业务的 传输， CCSDS便提出了支持宽带通信业务的高级在轨系统(AOS), AOS的提出 标志着CCSDS成为了一个成熟的太空宽带通信标准， 也成为了当前众多卫星通 信系统的首选通信标准， 其中包括我国的 “ 嫦娥 ＂ 探月工程[23] 。AOS开始的全 IP化，这样便使得太空网络与地面互联网的协议可以融合统一 ，所以像天地一体 化网络这类天地融合的网络非常适合使用CCSDS标准作为通信协议。</p>
<p>CCSDS于1999年提出了参考TCP&#x2F;IP模型的空间通信协议标准(Space Communication Protocol Specification, SCPS), SCPS具有四层结构， 每一层都采 用特定的协议， 网络层的协议是SCPS-NP协议， 传输层协议是SCPS-TP协议， 应用层协议是SCPS-TP协议， 为了保障空间通信的安全在网络层和传输层之间有一个安全层，安全层使用SCPS-TP协议。SCPS提出的背景是卫星通信系统的带宽容量较小、星上资源较少的时代，在设计上都以极大节约资源为前提，所以 性能和扩展性都不是很好，随着卫星通信技术的进一步发展，天地网络融合思想的出现 ，SCPS的缺陷渐渐暴露，无法满足卫星通信日益增长的需求，于是CCSDS于2007年提出了IP over CCSDS的概念， 将CCSDS的网络层及以上与TCP&#x2F;IP模型完全兼容，由于太空链路和地面通信链路的不一致，只需在网络层及以下进行链路数据转化，使得在空间链路上可以传输IP数据包，这样星上应用就可以同地面应用一样使用TCP&#x2F;IP模型[24] 。IPover CCSDS的提出，使得SCPS逐渐被 SIS取代， 只保留了传输层的SCPS-TP协议。新的CCSDS标准也被称为CCSDSAOS标准， 也是采用分层结构， 一共有<br>五层：物理层、数据链路层、 网络层、 传输层和应用层。 网络层及以上由SIS定义， 数据链路层由SLS定义。 如图2-11所示：</p>
<h2 id="3-有用，但是是CCSDS的详细协议Research-on-C…mble-Learning-朱明-pdf-x2F-Users-x2F-sunzekun-x2F-Desktop-x2F-Markdown-x2F-kk-x2F-有用，但是是CCSDS的详细协议Research-on-C…mble-Learning-朱明-pdf"><a href="#3-有用，但是是CCSDS的详细协议Research-on-C…mble-Learning-朱明-pdf-x2F-Users-x2F-sunzekun-x2F-Desktop-x2F-Markdown-x2F-kk-x2F-有用，但是是CCSDS的详细协议Research-on-C…mble-Learning-朱明-pdf" class="headerlink" title="3.  [有用，但是是CCSDS的详细协议Research on C…mble Learning_朱明.pdf](&#x2F;Users&#x2F;sunzekun&#x2F;Desktop&#x2F;Markdown&#x2F;kk&#x2F;有用，但是是CCSDS的详细协议Research on C…mble Learning_朱明.pdf)"></a>3.  [有用，但是是CCSDS的详细协议Research on C…mble Learning_朱明.pdf](&#x2F;Users&#x2F;sunzekun&#x2F;Desktop&#x2F;Markdown&#x2F;kk&#x2F;有用，但是是CCSDS的详细协议Research on C…mble Learning_朱明.pdf)</h2><p>CCSDS 协议标准体系的架构如图2-1 所示。CCSDS 协议标准体系与地基网络体系架构类似，都是五层的架构体系，包括应用层、传输层、网络层、链路层和物理层[26]。各层次的相关说明如下：</p>
<p>1）应用层：主要为用户提供一些空间应用服务，例如无损数据压缩、图像数据压缩、文件传输和应用特定协议等等。制定无损数据压缩和无损图像压缩的目的是尽可能多的收到有用数据的同时，还要尽量降低存储资源和传输资源。</p>
<p>2）传输层：该层主要负责数据的可靠传输，为上层（即应用层）提供服务。该层不仅包含可以提供数据传输的SCPS 传输协议（SCPS-TP），还包含为数据传输提供安全保障的两种安全协议，即SCPS-SP 和IPSec。3）网络层：该层定义两个网络层协议，即空间分组协议和SCPS-NP，主要是为了实现网络间的路由功能。但是该层协议并不能保证重传功能，因为重传功能需要上层（即传输层）提供。为了与地基网络兼容，使用封装技术后，IPv4 和IPv6 的数据包也可以通过空间数据链路进行传输。</p>
<p>4）链路层：该层又包含两个子层。首先是数据链路协议子层，该子层规定数据帧的传输方式，然后是同步和信道编码子层，该子层规定数据帧的编码方式和同步方式[26]。为了更好地适用空间的通信场景，在20 世纪末，空间数据系统咨询委员会提出4 种链路层通信协议和3 种同步和信道编码标准，分别是分包遥测（TM）协议[27]、分组遥控（TC）协议[28]、高级在轨系统（AOS）标准[29]、近距离Proximity-1 通信协议[30]、TM 同步和信道编码[31]、TC 同步和信道编码[32]和Proximity-1同步和信道编码[33]。</p>
<p>5）物理层：该层也是由两部分组成，分别是无线射频与调制系统和近距离Proximity-1 物理协议。无线射频与调制系统定义星地之间所使用的频段和调制方式等。近距离Proximity-1 物理协议主要是为链路层的同步和信道编码子层提供输入输出的时钟信号和一些状态信息。</p>
<p>据统计，国际上采用CCSDS 协议标准体系的航天任务已经将近700 个，并且国内的航天工程中，神舟飞船、风云卫星和嫦娥探月工程等也均采用CCSDS 协议标准体系[34]。</p>
<p>#CCSDS外网PPT：</p>
<p> [CCSDS USLP Activities April 2016.ppt](&#x2F;Users&#x2F;sunzekun&#x2F;Desktop&#x2F;Markdown&#x2F;kk&#x2F;CCSDS USLP Activities April 2016.ppt) </p>
<p> [CCSDS Telemetry:Telecommand Standards Restructured as Communications Protocols .pdf](&#x2F;Users&#x2F;sunzekun&#x2F;Desktop&#x2F;Markdown&#x2F;kk&#x2F;CCSDS Telemetry:Telecommand Standards Restructured as Communications Protocols .pdf) </p>
<p>#CCSDS知乎资料：</p>
<p>##1. <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/OAfdaDK_qA5551AJwYvuRg">卫星光通信关键技术及发展态势分析</a>:</p>
<p>国内外许多标准组织都开展了航天通信的标准化工作，不仅有传统的航天标准组织,还有许多通信标准组织。其中，国际标准组织有航天数据系统咨询委员会（Consultative Committee for Space Data Systems， CCSDS）、国际标准化组织（International Organization for Standardization，ISO）、国际标准组织国际电信联盟（International Telecommunication Union，ITU）和3GPP（3rd Generation Partnership Project）；欧盟的标准组织有欧洲电信标准协会（European Telecommunications Standards Institute，ETSI）、欧洲航天标准化合作组织（European Cooperation for Space Standardization，ECSS）、欧洲航天局（European Space Agency，ESA）；美国的标准组织有国际自动机工程师学会（SAE International）、美国航天航空学会（American Institute of Aeronautics and Astronautics，AIAA）、美国国防部标准化局；中国的标准组织有全国宇航技术及其应用标准化技术委员会和全国通信标准化技术委员会（CCSA）。</p>
<p>…</p>
<p>整体而言，由于卫星光通信在全球范围内的产业应用中的互通程度仍然较低，各国前期各自开展研发工作，网络架构中使用的各类技术不完全统一，且研究水平也存在差距。因此，在目前标准化进展处于初期起步阶段的情况下，全球标准化研究仍然由资历深且技术成熟度高的美国NASA在CCSDS中牵头主导，而其他标准化机构跟随其后在卫星光通信领域也开始进行相应布局。</p>
<p>##2. <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/6oudcFz5jr6ImrcHaxgnig">3名航天员实现天地通话，在空间站还能刷视频？这事没那么简单！</a></p>
<p>这次中国空间站还配备了Wi-Fi，航天员在太空中就可以与家人视频通话，还能上网冲浪，刷抖音之类的。那这是如何做到的呢？</p>
<img src="https://mmbiz.qpic.cn/mmbiz_jpg/9NB8kjbwc7AyAgZOicrED1ThTiaX5ibdMDIJdJ0YCPn6tXOBfwDbV95askOeicJvExpk9N4sUH4Oe5j8EJBR3C1Exw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片" style="zoom:33%;" />

<img src="https://mmbiz.qpic.cn/mmbiz_png/9NB8kjbwc7AyAgZOicrED1ThTiaX5ibdMDIaTzxZSRamO5QtsUbBltVKwgV2zNxkfWFlvVwEFQh73rVF7bUOPo9Zg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片" style="zoom:33%;" />

<p>在国际空间站建设初期，并没有配置因特网服务，所以能够发4封双向的电子邮件。这使得在国际空间站工作的宇航员生活十分单调。后来，配备了因特网后，还因为网络不够安全，导致宇航员的电脑中病毒。我们国家空间站汲取了这个经验，所以给航天员配备了因特网服务。</p>
<p>要配备这项服务，主要的是让因特网业务数据，在空间站和地面的因特网之间实现双向传输，这个过程需要穿越空间站局域网，空间通信链路、航天地面测控通信网、地面因特网等一系列通信环节，而借助的通信设备就是中继卫星。</p>
<img src="https://mmbiz.qpic.cn/mmbiz_jpg/9NB8kjbwc7AyAgZOicrED1ThTiaX5ibdMDIicWicN4MPpfTJYPObZkERNASnnQhdKVywcrVzxZQCup3aESnibUHibyOdA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片" style="zoom:33%;" />



<p>由于在地面因特网运行的TCP／IP协议，如果空间站内也采用TCP／IP（传输控制协议／互联网协议)，传输性能会受到物理因素的影响，导致延迟大，误码率高。</p>
<p>为了解决这个问题，科学家只能基于TCP／IP协议专门制定出CCSDS的AOS协议。利用这个协议，不仅安全，同时可以解决误码率高，不稳定延迟大的问题。</p>
<img src="https://mmbiz.qpic.cn/mmbiz_jpg/9NB8kjbwc7AyAgZOicrED1ThTiaX5ibdMDI5l4hiaFJibUDsc77sJPO7c6xqKvQds8UtLl6gqvFDAfT9iav2IJ6O8cEA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片" style="zoom:33%;" />

<p>所以，别看只是一个安装wifi配置网络的事情，背后所需要的技术也是非常前沿的。这也从侧面让我们了解到中国空间站建设的难度有多高。</p>
<p>##3. <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/YcgnRY3SJ63xDt8kkMhyaw">卫星可以不用管，一体化测控技术有点酷</a></p>
<p>实际上，各国建立的航天测控站都有相当大的余力，特别是那些为了可靠而设有双套设备的测控站，所以各国测控站相互合作，充分发挥测控资源，降低航天测控任务的费用，已经成为趋势。国际空间数据咨询委员会已经提出了一系列CCSDS标准，作为航天测控站互相联通组网的标准接口。这为在全球商业化运营测控网打下了坚实的技术基础。</p>
<p>##4. <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/NFzULKjwKekCjR7fIa_5ow">宽带卫星通信网络技术发展态势与发展建议</a></p>
<p><strong>2.3 “智能+网络”的未来卫星网络</strong></p>
<p>以低轨道巨型星座和混合网络架构为特征的卫星网络呈现快速发展趋势，正在实现从“天星地网”向“天基组网”的演进。传统天基网络技术已基本成熟，包括国际空间数据系统咨询委员会（CCSDS）、时延容忍网络（Delay Tolerant Network, DTN）在内的传统空间网络体制协议均已完成标准化。同时，地面网络技术向太空网络的辐射和带动作用日益凸显。学术界正在探索软件定义网络（Software Defined Network, SDN）、信息中心网络（Information Centric Networking, ICN）等新兴网络技术在巨型星座组网中的应用，以提供更为便捷的复杂网络管理和多业务承载。</p>
<p>##5. <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/-9BlAQqApaoGLfRgtJIn7Q">NASA开源软件实践与思考</a></p>
<p><strong>基于开源软件的卫星健康状态监视原型系统</strong></p>
<p>3.1<strong>系统介绍</strong></p>
<p>系统用于监视卫星平台健康状态，目前包括但不限于CPU温度、GPU温度、CPU使用率、RAM使用率、ROM使用率、姿态测量参数（如加速度传感器XYZ，磁强计XYZ等）等信息，将健康状态信息（SOH: State Of Health）以CCSDS数据包格式封装，通过无线射频链路发送到地面站系统，以图表形式进行显示信息。</p>
<h1 id="网页资料"><a href="#网页资料" class="headerlink" title="网页资料"></a>网页资料</h1><h2 id="一文读懂：天地一体化信息网络的那点事"><a href="#一文读懂：天地一体化信息网络的那点事" class="headerlink" title="一文读懂：天地一体化信息网络的那点事"></a><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/391524514">一文读懂：天地一体化信息网络的那点事</a></h2><h2 id="1、基于CCSDS的协议体系"><a href="#1、基于CCSDS的协议体系" class="headerlink" title="1、基于CCSDS的协议体系"></a><strong>1、基于CCSDS的协议体系</strong></h2><p>CCSDS定义的协议体系结构包括：应用层、传输层、网络层、数据链路层、物理层。其中，每层包含几个可组合的协议。</p>
<p><img src="https://pic1.zhimg.com/80/v2-cbb6a5333196b2465ab3b45764181c7c_1440w.jpg" alt="img"></p>
<p>▲CCSDS协议体系</p>
<p>1）物理层：CCSDS 定义了射频和调制系统，规定了航天器和地面测控站间的物理层协议。该协议中 Prox－1 链路协议定义了邻近空间链路的物理层特性。</p>
<p>2）数据链路层：CCSDS 数据链路子层定义了在空间链路上用数据包( 如数据帧) 传输数据的方法。同步和信道编码子层定义了在空间链路上传输“帧”的同步和信道编码的方法。CCSDS 数据链路协议子层包含四个协议: TC 空间数据链路协议、TM 空间数据链路协议、AOS 空间数据链路协议、Prox－1 空间链路协议的数据链路层。以上协议规定了空间链路中传输数据的能力，统称为 SDLP( space data link protocol，空间数据链路协议) 。与之对应，CCSDS 还规定了数据链路层的同步和信道编码子层的三个规范: TM 同步和信道编码、TC 同步和信道编码、Prox－1 空间链路协议的编码和同步层协议。</p>
<p>3）网络层：CCSDS 规定了两个网络层协议: 空间分包协议 SPP、SCPS－NP，实现了空间网络的路由功能。SPP 基于无连接，不保证数据的顺序发送和完整性。SPP 的核心是 提 前 配 置 LDP ( Logical DataPath) ，并用 Path ID 代替完整的端地址来标识 LDP，从而提高空间信息传输效率，但只适合静态路由的通信场合。LDP 是单向的，可以是点到点或组播路由。不同用户( 对应于不同的 LDP) 可以利用复用 &#x2F;去复用方法共享逻辑信道。</p>
<p>与标准 IP 协议相比，SCPS-NP 协议有三方面改进: NP 提供 4 种包头供用户在效率和功能之间选用;既支持面向连接的路由也支持面向无连接的路由; 与ICMP 相比，SCPS 控制信息协议 SCMP 提供了链路中断消息。因特网的 IPv4 和 IPv6 分组也可以通过空间数据链路协议传输，与 SPP、SCPS-NP 可以复用或独用空间数据链路。</p>
<p>4） 传输层：CCSDS 传输协议 SCPS-TP，向空间通信用户提供端到端传输服务。TP 针对网络拥塞、误码或链路中断导致的数据丢失，能够进行识别和区分处理，并实现了头部压缩、选择否定确认、时间戳、速率控制等功能。传输层数据一般由网络层协议传输，在一些情况下传输层数据也可以直接由链路层协议传输，Internet的 TCP 和 UDP 可以运行于 IPv4、IPv6、SCPS-NP 之上。SCPS 安全协议 ( SCPS-SP ) 和 Internet 安全协议( IPSec) 可以和传输层协议配合使用，提供端到端的数据保护。</p>
<h1 id="CCSDS架构"><a href="#CCSDS架构" class="headerlink" title="CCSDS架构"></a>CCSDS架构</h1><p>##国外&amp;国内</p>
<p>##DTN&amp;深空通信&amp;卫星互联网</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/06/CCSDS%E7%9B%B8%E5%85%B3%E8%B5%84%E6%96%99/" data-id="cl77bm6pm00022kfy6vlec6fd" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-然博_视频" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/27/%E7%84%B6%E5%8D%9A_%E8%A7%86%E9%A2%91/" class="article-date">
  <time class="dt-published" datetime="2022-06-26T20:33:12.450Z" itemprop="datePublished">2022-06-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="视频"><a href="#视频" class="headerlink" title="视频"></a>视频</h1><p>##1. 背景： 万物互联的智能社会<em>、卫星的广覆盖和低时延、远程导弹控制、远程柔性工业控制</em>、远程重型机械控制*、确定性时延及抖动需求（这个咋整）</p>
<p>###1.1 有关导弹的：</p>
<p>俄罗斯打乌克兰：俄精确打击武器多为惯性+单模末制导等复合制导体制，多个型号还配有卫星导航+地形匹配系统，命中精度最高可达3 m，可高精度识别并命中固定目标。</p>
<p>![截屏2022-06-26 下午4.30.40](&#x2F;Users&#x2F;sunzekun&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;截屏2022-06-26 下午4.30.40.png)</p>
<p>美国：指挥通信系统，改进现有的C2BMC 系统，使其具备应对高超声速武器的指控、管理与通信能力；构建天空地一体化的通信传输网络，为高超声速武器预警、探测、跟踪、拦截等防御各阶段的数据传输、信息通信、作战管理和指挥控制提供可靠、无缝、弹性、低延迟的传输连接保障。作为“骨干”通信网络，由300~500 颗卫星组成的传输层星座，旨在将指挥和控制系统与传感器系统、拦截系统等连接起来，为高超声速武器预警、探测、跟踪、拦截等防御各阶段的数据传输、信息通信、作战管理和指挥控制提供可靠、无缝、弹性、低延迟的传输连接保障。SDA 计划分阶段发展传输层卫星星座，根据合同，第0 批（Tranche 0）传输层卫星即初始传输层卫星共建造20 颗，计划在2022 财年部署完成。计划2024 财年部署第1 批（Tranche 1）共126 颗，2026 财年部署第2批（Tranche 2）。[高超声速武器防御装备体系发展及顶层思]</p>
<p>“ 星链” 星座具有高速率通信保障、高精度侦查导航、高可靠导弹防御、高可控作战集群和高灵活塑造态势等多方面军事用途， 显示出极高军事价值。高速率通信保障、高精度侦查导航、高可靠导弹防御、高可控作战集群、高灵活塑造态势。2018年邢强研究团队利用计算机模拟“ 星链” 星座拦截核弹头能力， 在中弹道对抗演习中，“ 星链” 星座在轨拦截多达350枚洲际弹道导弹并全部成功， 每颗核弹头均有遭到5-7次拦截的可能。此外“ 星链”卫星可进行对撞自毁或者多星自毁来产生大量空间碎片， 从而封锁整个轨道以达到拦截弹道导弹核弹头的目的， 影响他国的核打击能力。[“ 星链” 星座的军事应用分析]</p>
<p>除了进行对地观测、电子侦察等任务以外，这类低轨、超低轨卫星星座还可用于高超音速导弹的精确跟踪。但预警卫星对于探测、跟踪飞行轨迹变化无常，滑翔段红外特征相对发动机尾焰而言较小的高超音速飞行器有些力不从心。而组网后的低轨道卫星则可以完成这个任务，既可以进行接力跟踪，也能够进行组网定位，并能更快地将数据传输到反导系统。<a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1713121571553112970&wfr=spider&for=pc">军事用途</a></p>
<p>背景和挑战直接放视频，占满屏幕。</p>
<p>方法和仿真PPT+视频。</p>
<ol>
<li><p>挑战：卫星的动态性，分为拓扑的跳变变化和时延的渐变变化 （拓扑链路的跳变0-1，链路时延的渐变，时延的变换）</p>
</li>
<li><p>基于CBS的确定性端到端时延控制与路径规划方法：队列模型、基于信用值的转发控制、路径规划、容量规划</p>
<p>一整章大白纸，左边是四个标题，放那些视频。路径规划、容量规划在旁边配文字。</p>
</li>
<li><p>仿真：以CBS的带宽分配为输入，为每条流寻找符合时延要求的路径、算法的关键函数代码</p>
</li>
<li><p>效果：稳定的路由时延<em>、控制机械臂</em>、控制小车*<br>  第3、4点可以用PPT+视频结合的形式</p>
</li>
</ol>
<p>导弹控制文字精简、文字数量一致 ✅</p>
<p>神经网络的动态图全部删掉，因为我学不来 ✅</p>
<p>应用前加PPT，写低轨卫星确定性网络可服务于这四种应用，四个应用用视频依次展示✅</p>
<p>应用的结构图，留静态的，DIP确定性网络替换成卫星确定性网络 ✅</p>
<p>导弹的应用后面加一个类似的结构示意图✅</p>
<p>调整一下前面背景的顺序吧：<br>万物互联的社会那里，加几个字：全连接、低时延、低抖动、高可靠性的网络质量需求 ✅</p>
<p>低轨卫星特点那里，精炼一下文字，就留低轨卫星优势：广覆盖   低时延就可以了，然后注意动画和这两个特点的对应 ✅</p>
<p>后面那四个业务，展示形式做的一样吧 ✅</p>
<p>挑战那里，xx那里你写：提供确定性网络服务✅</p>
<p>容量规划补充进去✅</p>
<p>仿真效果那里，把dip字样换成卫星网络确定性端到端✅</p>
<p>然博：</p>
<p>先列一个总的提纲</p>
<p>每一段开始的时候，在画面中间可以有一个大标题，说一下这一部分是在讲啥。</p>
<p>字要大一点，突出一点✅</p>
<p>基于CBS的确定性端到端时延控制与路径规划方法</p>
<p>队列模型</p>
<p>基于信用值得转发控制</p>
<p>路径规划</p>
<p>容量规划</p>
<p>先期验证效果</p>
<p>控制机械臂</p>
<p>控制小车</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/27/%E7%84%B6%E5%8D%9A_%E8%A7%86%E9%A2%91/" data-id="cl77bm6pt000c2kfy94v7e8ek" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CCSDS协议" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/25/CCSDS%E5%8D%8F%E8%AE%AE/" class="article-date">
  <time class="dt-published" datetime="2022-06-24T16:49:58.873Z" itemprop="datePublished">2022-06-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="CCSDS协议"><a href="#CCSDS协议" class="headerlink" title="CCSDS协议"></a>CCSDS协议</h1><h2 id="2-1-空间通信协议的历史"><a href="#2-1-空间通信协议的历史" class="headerlink" title="2.1 空间通信协议的历史"></a>2.1 空间通信协议的历史</h2><p>传统上，从航天器传输的遥测数据采用时分复用（TDM）方案进行格式化，其中数据项根据预定义的复用规则被复用为固定长度帧的连续流。为了设计和实施航天器数据系统，每个项目都被迫开发一个由该项目单独使用的自定义系统，但地面跟踪网络除外，因为该领域缺乏既定标准。</p>
<p>然而，以微处理器为基础的航天器仪器和子系统的出现，使遥测系统变得更加灵活，具有更大的吞吐量，从而可以有效地传输由机载软件处理的数据。</p>
<p>20世纪80年代初，&#x3D;&#x3D;CCSDS为数据包遥测协议制定了一项国际标准&#x3D;&#x3D;，该协议能够使用称为源数据包的可变长度数据单元有效地发送经过处理的遥测数据。航天器上各种仪器和子系统生成的源数据包以连续、固定长度的传输帧流传输到地面。该标准已被许多空间项目使用，使其能够共享机载和地面数据处理设备。</p>
<p>基于一个类似的概念，&#x3D;&#x3D;CCSDS在数据包遥测后不久制定了另一个关于遥控的国际标准&#x3D;&#x3D;，用于向带有称为TC数据包的数据单元的航天器发送命令。发送给航天器上各种仪器和子系统的TC数据包通过一系列零散、可变长度的传输帧从地面传输。</p>
<p>20世纪80年代末，CCSDS扩展了上述标准，以满足国际空间站等先进轨道系统的要求，并&#x3D;&#x3D;提出了第三个标准，即AOS&#x3D;&#x3D;。AOS标准添加到数据包遥测标准服务中，用于传输各种类型的在线数据（如音频和视频数据）。它可以用于空间对地和地对空间链路。AOS使用与数据包遥测标准相同的数据包结构，但帧格式略有不同。</p>
<p>CCSDS后来对这三个标准（数据包遥测、遥控和AOS）进行了重组，以便以更结构化和统一的方式定义协议，以下标准取代了原始标准：</p>
<p>​	a） 空间分组协议；</p>
<p>​	b） TM、TC和AOS空间数据链路协议；</p>
<p>​	c） TM和TC同步和信道编码。</p>
<p>作为航天器和地面站之间射频（RF）信号的国际标准，CCSDS制定了一个称为&#x3D;&#x3D;射频和调制系统&#x3D;&#x3D;的标准。本标准规定了用于传输数据包和帧的射频信号的特性。</p>
<p>20世纪90年代，CCSDS开发了另一套协议，统称为&#x3D;&#x3D;空间通信协议规范（SCPS）&#x3D;&#x3D;，其中包括SCPS网络协议（SCPS-NP）、SCPS安全协议（SCPS-SP）、SCPS传输协议（SCPS-TP），和SCPS文件协议（SCPS-FP）。SCPS协议通常基于Internet协议。但是，在设计SCPS协议时，对互联网协议进行了修改和扩展，以满足空间任务的具体需要。CCSDS已停用除SCPS-TP之外的所有SCPS协议。</p>
<p>为响应空间任务与机载大容量存储器之间传输文件的需求，CCSDS开发了一种称为&#x3D;&#x3D;CCSDS文件传输协议（CFDP）&#x3D;&#x3D;的协议。该协议提供了通过不可靠的协议（例如，空间分组协议）可靠高效地传输文件的能力。</p>
<p>在数据压缩领域，CCSDS制定了&#x3D;&#x3D;无损数据压缩标准和图像数据压缩标准&#x3D;&#x3D;，以增加科学回报或减少对机载内存、站点联系时间和数据归档量的要求。前一个标准保证完全重建原始数据而不会在过程中产生任何失真，而对于后一个标准，压缩过程中使用的量化或其他近似可能会导致无法在没有一些失真的情况下再现原始数据集。</p>
<p>最近，CCSDS开发了一种称为&#x3D;&#x3D;1-邻近空间链路协议的协议&#x3D;&#x3D;（参考文献[18]、[19]、[20]和[32]），用于邻近空间链路。邻近空间链路被定义为短程、双向、固定或移动无线电链路，通常用于固定探测器、着陆器、漫游器、轨道星座和轨道中继之间的通信。该协议定义了数据链路协议（参考文献[18]）、编码和同步方法（参考文献[19]）以及射频和调制特性（参考文献[20]）。</p>
<p>安全是许多空间任务的重大关切。CCSDS发布了多份文件，包括&#x3D;&#x3D;CCSDS协议在安全系统中的应用&#x3D;&#x3D;（参考文献[37]）、&#x3D;&#x3D;空间数据系统安全体系结构&#x3D;&#x3D;（参考文献[53]），以及&#x3D;&#x3D;CCSDS密码算法&#x3D;&#x3D;（参考文献[54]），为希望使用&#x3D;&#x3D;CCSDS空间通信协议&#x3D;&#x3D;进行航天器控制和数据处理，但也需要一定程度的安全或数据保护的任务提供指导。</p>
<h2 id="2-2-协议层"><a href="#2-2-协议层" class="headerlink" title="2.2 协议层"></a>2.2 协议层</h2><h3 id="2-2-1-总结"><a href="#2-2-1-总结" class="headerlink" title="2.2.1 总结"></a>2.2.1 总结</h3><p>通信协议通常与OSI基本参考模型（参考文献[2]）中定义的七个层之一相关联。虽然一些空间通信协议与现场视察七层模型不太匹配，但本报告使用该模型对空间通信协议进行分类。</p>
<p>为ISO模型的以下五个层次定义了空间通信协议：</p>
<p>​	a）物理层</p>
<p>​	b）数据链路层</p>
<p>​	c）网络层</p>
<p>​	d）传输层</p>
<p>​	e）应用层</p>
<p>与大多数地面网络一样，OSI模型的会话层和表示层协议很少在空间链路上使用。</p>
<p>图2-1显示了分为上述五层的空间通信协议。图2-2显示了这些协议的一些可能组合。</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午6.21.06.png" alt="截屏2022-06-23 下午6.21.06" style="zoom:33%;" />

<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午6.21.17.png" alt="截屏2022-06-23 下午6.21.17" style="zoom:33%;" />

<p>在图2-1中，有两个协议不对应于单个层。&#x3D;&#x3D;CCSDS文件传递协议（CFDP）&#x3D;&#x3D;具有传输层和应用层的功能。&#x3D;&#x3D;1-邻近空间链路协议&#x3D;&#x3D;具有数据链路和物理层的功能。</p>
<p>CCSDS没有正式定义空间通信协议的应用程序接口（API），但大多数CCSDS标准按照ISO确立的约定，以&#x3D;&#x3D;原语的形式提供抽象服务定义&#x3D;&#x3D;（见参考文献[21]）。原语是协议层提供的服务的抽象表示，但它不依赖于任何实现技术。本抽象规范可作为开发API的参考。</p>
<p>在以下小节中，将简要介绍图2-1所示的协议。第3节将解释这些协议的主要特点。</p>
<h3 id="2-2-2-物理层"><a href="#2-2-2-物理层" class="headerlink" title="2.2.2 物理层"></a>2.2.2 物理层</h3><p>CCSDS有一个称为&#x3D;&#x3D;射频和调制系统&#x3D;&#x3D;（参考文献[10]）的物理层综合标准，用于航天器和地面站之间的空间链路。邻近1空间链路协议还包含关于邻近空间链路物理层的建议（参考文献[20]）。</p>
<h3 id="2-2-3-数据链路层"><a href="#2-2-3-数据链路层" class="headerlink" title="2.2.3 数据链路层"></a>2.2.3 数据链路层</h3><p>CCSDS在OSI模型的数据链路层定义了两个子层：__数据链路协议子层__和__同步与信道编码子层__。__数据链路协议子层__指定使用称为传输帧的数据单元通过点到点空间链路传输高层提供的数据单元的方法。__同步和信道编码子层__指定通过空间链路传输传输帧的同步和信道编码方法。</p>
<p>CCSDS为数据链路层的数据链路协议子层开发了四种协议：</p>
<p>​	a） TM空间数据链路协议（参考文献[5]）；</p>
<p>​	b） TC空间数据链路协议（参考文献[6]）；</p>
<p>​	c） AOS空间数据链路协议（参考文献[7]）；</p>
<p>​	d） 邻近1空间链路协议数据链路层（参考文献[18]）。</p>
<p>上述协议提供了通过单个空间链路发送数据的能力。</p>
<p>TM、TC和AOS具有使用空间数据链路安全（SDLS）协议（参考文献[43]）将安全用户数据插入到帧中的规定。</p>
<p>然而，到目前为止，还没有为邻近-1制定任何安全要求。SDLS协议可以为TM传输帧、AOS传输帧和&#x2F;或TC传输帧提供安全服务，例如身份验证和机密性。请注意，在这些协议中使用SDLS功能是可选的。</p>
<p>CCSDS为数据链路层的同步和信道编码子层制定了三个标准：</p>
<p>​	a） TM同步和信道编码（参考文献[8]）；</p>
<p>​	b） TC同步和信道编码（参考文献[9]）；</p>
<p>​	c） 邻近1空间链路协议编码和同步层（参考文献[19]）。</p>
<p>TM同步和信道编码与TM或AOS空间数据链路协议一起使用，TC同步和信道编码与TC空间数据链路协议一起使用，邻近1空间链路协议编码和同步层与邻近1空间链路协议数据链路层一起使用。</p>
<p>在本文件中，TM、TC和AOS空间数据链路协议以及邻近-1空间链路协议（数据链路层）称为空间数据链路协议。</p>
<h3 id="2-2-4-网络层"><a href="#2-2-4-网络层" class="headerlink" title="2.2.4 网络层"></a>2.2.4 网络层</h3><p>网络层的空间通信协议提供通过整个数据系统（包括机载和地面子网）路由或转发更高层数据的功能。</p>
<p>CCSDS有两个网络层接口标准：</p>
<p>​	a） 空间分组协议（参考文献[4]）；</p>
<p>​	b） 封装服务（参考文献[29]）。</p>
<p>对于空间分组协议，协议数据单元（PDU）由航天器或地面上的应用程序进程生成和使用。</p>
<p>CCSDS封装服务允许将SANA注册表（参考文献[47]）中定义的CCSDS识别协议的PDU封装为两种类型的CCSDS数据包之一，即空间数据包或封装数据包。然后，这些数据包可以通过CCSDS空间数据链路协议在空间链路上传输。</p>
<p>CCSDS识别的互联网数据报（参考文献[44]中列出）也可以通过CCSDS空间数据链路协议通过空间链路传输，使用IP over CCSDS（参考文献[45]）复用或不复用。</p>
<h3 id="2-2-5-传输层"><a href="#2-2-5-传输层" class="headerlink" title="2.2.5 传输层"></a>2.2.5 传输层</h3><p>传输层的空间通信协议为用户提供端到端的传输服务。</p>
<p>CCSDS为传输层开发了SCPS传输协议（SCPS-TP）（参考文献[13]）。</p>
<p>传输层协议的PDU通常通过空间链路与网络层协议一起传输，但它们可以通过空间数据链路直接传输。</p>
<p>互联网中使用的传输协议（如TCP，参考文献[24]和UDP，参考文献[25]）也可用于CCSDS空间链路上的IP数据报，参考文献[45]。IPSec（参考文献[27]）可与Internet套件的传输协议一起使用，以提供端到端数据保护能力。</p>
<h3 id="2-2-6-应用层"><a href="#2-2-6-应用层" class="headerlink" title="2.2.6 应用层"></a>2.2.6 应用层</h3><p>应用层的空间通信协议为用户提供端到端的应用服务，如文件传输和数据压缩。</p>
<p>CCSDS为应用层开发了五个协议：</p>
<p>​	a） 异步消息服务（AMS）（参考文献[46]）；</p>
<p>​	b） CCSDS文件交付协议（CFDP）（参考文献[15]）；</p>
<p>​	c） 无损数据压缩（参考文献[16]）；</p>
<p>​	d） 图像数据压缩（参考文献[17]）；</p>
<p>​	e） 无损多光谱和高光谱图像压缩（参考文献[48]）。</p>
<p>AMS是用于端到端任务数据系统消息传输的应用层协议。</p>
<p>CFDP提供应用层的功能（即文件管理功能）。CFDP存储和转发覆盖过程提供跨多个链路层跃点的特定于应用程序的数据传输。</p>
<p>每个项目（或机构）也可以选择使用CCSDS不推荐的特定于应用程序的协议，通过CCSDS空间通信协议来满足其在应用层的任务要求。</p>
<p>应用层协议的PDU通常通过空间链路使用传输层的协议传输，但它们可以直接使用网络层的协议传输。</p>
<p>互联网中使用的应用程序协议（如FTP，参考文献[26]）也可以在SCPS-TP、TCP和UDP空间链路上使用。</p>
<h1 id="3-空间通信协议的主要特点"><a href="#3-空间通信协议的主要特点" class="headerlink" title="3. 空间通信协议的主要特点"></a>3. 空间通信协议的主要特点</h1><h2 id="3-1-物理层"><a href="#3-1-物理层" class="headerlink" title="3.1 物理层"></a>3.1 物理层</h2><p>CCSDS射频和调制系统推荐标准（参考文献[10]）推荐了用于航天器和地面站之间空间链路通信的射频和调制系统的特性。</p>
<p>1-邻近空间链路协议物理层（参考文献[20]）还包含了关于邻近空间链路物理层的建议。</p>
<h2 id="3-2-数据链路层"><a href="#3-2-数据链路层" class="headerlink" title="3.2 数据链路层"></a>3.2 数据链路层</h2><p>###3.2.1 数据链路协议的一般特征</p>
<p>CCSDS为数据链路层的数据链路协议子层开发了四种协议：</p>
<p>​	a） TM空间数据链路协议（参考文献[5]）；</p>
<p>​	b） TC空间数据链路协议（参考文献[6]）；</p>
<p>​	c） AOS空间数据链路协议（参考文献[7]）；</p>
<p>​	d） 接近-1空间链路协议的数据链路协议子层部分（参考文献[18]）。</p>
<p>这些协议（统称为空间数据链路协议）提供了在空间链路上传输各种类型数据的能力，但其主要功能是传输称为数据包的可变长度数据单元。</p>
<p>空间数据链路协议传输的每个数据包格式必须具有CCSDS识别的数据包版本号（PVN）。这些数字包含在SANA中（参考文献[28]）。具有授权数据包版本号的数据包可以通过空间数据链路协议直接传输，但CCSDS有另一种机制，可以使用一种称为封装服务的服务传输CCSDS和非CCSDS协议的PDU，该服务在参考文献【29】中定义。利用该服务，数据包由封装在参考文献【4】中定义的空间数据包或参考文献【29】中定义的封装数据包中的空间数据链路协议传输。</p>
<p>TM空间数据链路协议通常用于（但不限于）将遥测数据从航天器发送到地面站（即通过返回链路）。TC空间数据链路协议通常用于（但不限于）从地面站向航天器发送命令（即在前向链路上）。如果航天器与地面之间需要双向高速通信（如音频和视频），AOS空间数据链路协议可单独用于返回链路，或同时用于前向链路和返回链路。1-邻接空间链路协议将在接近空间链路上使用，其中接近空间链路定义为短程、双向、固定或移动无线电链路，通常用于固定探测器、着陆器、漫游器、轨道星座和轨道中继之间的通信。</p>
<p>空间数据链路协议使用的协议数据单元称为传输帧。TM和AOS空间数据链路协议使用固定长度的传输帧来促进噪声链路上的稳健同步过程，而TC空间数据链路协议和邻近1空间链路协议使用可变长度传输帧来促进短消息的短延迟接收。</p>
<p>所有空间数据链路协议的一个关键特征是“虚拟信道”的概念。虚拟信道设施允许在多个高层数据流之间共享一个物理信道（在单个方向上通过空间链路传输的比特流），其中每个数据流可能具有不同的服务需求。因此，可以将单个物理信道划分为几个单独的逻辑数据信道，每个信道称为虚拟信道（VC）。通过物理信道传输的每个传输帧属于物理信道的虚拟信道之一。</p>
<p>TC空间数据链路协议具有重新传输丢失或损坏数据的功能，以确保在空间链路上按顺序传输数据，而不会出现间隙或重复。该功能由称为通信操作程序-1（COP-1）的重传控制机制提供，该程序在单独的文件（参考文献[30]）中定义。（此功能不一定保证端到端的完整交付。）邻近1空间链路协议也具有类似的功能，称为COP-P，该功能在数据链路层推荐标准（参考文献[18]）中定义。TM空间数据链路协议和AOS空间数据链路协议都没有这样的功能，因此，如果需要完全传输数据，则必须通过更高层协议进行重传。</p>
<p>TM和AOS空间数据链路协议应与TM同步和信道编码推荐标准（参考文献[8]）一起使用。TC空间数据链路协议应与TC同步和信道编码推荐标准（参考文献[9]）一起使用。《TM信道编码剖面洋红色手册》（参考文献[51]）为用户提供了在不同任务剖面中遥测链路使用各种编码方案的指导。TM、TC和AOS空间数据链路协议应在射频和调制系统推荐标准的基础上使用（参考文献[10]）。</p>
<p>邻近1空间链路协议数据链路层（参考文献[18]）应与邻近1空间链路协议数据编码和同步层（参考文献[19]）一起使用，并位于邻近1空间链路协议物理层（参考文献[20]）之上。</p>
<p>参考文献【31】概述了TM、TC和AOS空间数据链路协议的概念和基本原理。参考文献[32]概述了近距离-1空间链路协议的基本原理、架构和场景。</p>
<h3 id="3-2-2-数据链路协议使用的标识符"><a href="#3-2-2-数据链路协议使用的标识符" class="headerlink" title="3.2.2 数据链路协议使用的标识符"></a>3.2.2 数据链路协议使用的标识符</h3><p>空间数据链路协议提供链路标识符以识别数据流。标识符名称及其值位于空间分配号码管理局（SANA）中。SANA是根据CCSDS创建的所有协议注册处的注册人。SANA取代了失效的空间链接标识符蓝皮书。CCSDS全球航天器识别领域：代码分配控制程序蓝皮书（参考文献[52]）包含了关于请求、分配和放弃CCSDS SCID领域代码的程序。</p>
<p>TM、TC和AOS空间数据链路协议具有以下三个标识符：传输帧版本号（TFVN）、航天器标识符（SCID）和虚拟信道标识符（VCID）。</p>
<p>传输帧版本号（TFVN）用于区分不同的传输帧。然而，不同的传输帧不能在物理信道上复用。</p>
<p>TFVN和SCID的串联称为主信道标识符（MCID），用于识别与空间链路相关的航天器。</p>
<p>物理信道上具有相同MCID的所有传输帧构成主信道（MC）。主通道由一个或多个虚拟通道组成，每个虚拟通道都用VCID标识。在大多数情况下，物理信道仅承载单个MCID的传输帧，并且主信道将与物理信道相同。然而，物理信道可以承载具有多个MCID（具有相同的TFVN）的传输帧。在这种情况下，物理信道由多个主信道组成。物理信道由物理信道名称标识，该名称由管理层设置，不包括在传输帧的标头中。</p>
<p>TC空间数据链路协议使用称为多路复用器接入点标识符（MAP ID）的可选标识符，该标识符用于在虚拟信道中创建多个数据流。具有相同映射ID的虚拟通道上的所有传输帧构成一个映射通道。如果使用贴图ID，则虚拟通道由一个或多个贴图通道组成。</p>
<p>图3-1显示了TM、TC和AOS空间数据链路协议信道之间的关系。</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午7.43.27.png" alt="截屏2022-06-23 下午7.43.27" style="zoom:33%;" />

<p>1-邻近空间链路协议数据链路层使用三元组多路复用功能，该三元组用于链路内的特定功能。航天器标识符（SCID）根据源标识符或目的标识符识别链路连接中传输的传输帧的源或目的地。物理信道标识符（PCID）提供最多两个独立的多路复用信道。端口ID提供了在内部（在收发器的输出接口处）将用户数据路由到特定逻辑端口（例如应用程序或传输过程）或物理端口（例如板载总线或物理连接（包括硬件命令解码器））的方法。</p>
<p>表3-1总结了空间数据链路协议的标识符。这些ID的值由SANA注册中心维护（参考文献[47]）。</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午7.43.59.png" alt="截屏2022-06-23 下午7.43.59" style="zoom:33%;" />

<p>###3.2.3 数据链路协议提供的服务</p>
<p>空间数据链路协议提供多种服务，用于在空间链路上传输各种数据。最重要的服务是传输称为分组的可变长度数据单元（即网络层协议的协议数据单元）的服务。除此服务外，空间数据链路协议还提供以下服务：传输具有专用（非CCSDS）格式的固定或可变长度数据单元、用于报告实时功能的短固定长度数据单元以及位流。</p>
<p>表3-2显示了按服务传输的数据类型分类的TM&#x2F;TC&#x2F;AOS空间数据链路协议提供的服务的摘要。有关这些服务的完整定义，请参阅参考文献【5】、【6】和【7】。</p>
<p>注：由于推荐标准（参考文献[18]）中未给出正式的服务定义，因此本表中不包括接近-1空间链路协议数据链路层。尽管没有正式的服务定义，但接近度-1可以提供由分组服务、封装服务和TC VCA服务提供的相同SDU。</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午7.44.33.png" alt="截屏2022-06-23 下午7.44.33" style="zoom:33%;" />

<p>注：</p>
<ol>
<li>空间数据链路协议直接传输的数据包必须具有CCSDS授权的数据包版本号。这些数据包版本号见参考文献【28】。其他数据包可以使用参考文献【29】中定义的封装服务进行传输。</li>
<li>FSH&#x3D;帧辅助标题。</li>
<li>3OCF&#x3D;操作控制字段。</li>
</ol>
<p>###3.2.4 同步和信道编码</p>
<p>同步和信道编码子层的标准提供了在空间链路上传输传输帧所需的一些附加功能。这些功能包括定界&#x2F;同步传输帧、纠错编码&#x2F;解码和位转换生成&#x2F;删除。CCSDS有五个同步和信道编码标准：</p>
<p>​	a） 一组三种TM规范：</p>
<p>​		1）TM同步和信道编码（参考文献[8]），</p>
<p>​		2）用于高速遥测应用的灵活高级编码和调制方案（参考文献[49]），或“SCCC”，</p>
<p>​		3） ETSI DVB-S2标准（参考文献[50]）或“DVB-S2”上的CCSDS空间链路协议；</p>
<p>​	b） TC同步和信道编码（参考文献[9]）；</p>
<p>​	c） 1-邻近空间链路协议编码和同步子层（参考文献[19]）。</p>
<p>三个TM规范定义了TM或AOS空间数据链路协议使用的备选同步和信道编码方案，TC同步和信道编码定义了TC空间数据链路协议使用的同步和信道编码方案，以及邻近1空间链路协议编码和同步子层定义与邻近1空间链路协议一起使用的同步和信道编码方案。</p>
<p>建议选项a）2）和a）3）仅用于高速下行。TM信道编码配置文件（参考文献[51]）提供了关于如何完成信道编码选项的建议。</p>
<p>表3-3总结了同步和信道编码标准提供的功能和方案。</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午7.46.15.png" alt="截屏2022-06-23 下午7.46.15" style="zoom:33%;" />

<p>注：</p>
<pre><code>1. 表中的注释“*”表示可选功能。
1. 当表格的一个方框显示多个选项时，在给定时间只能应用一个选项。
1. 当仅提及纠错方案时，意味着该方案还能够验证帧；ie. 宣布其错误或无错误。在其他情况下，对于TM/TC/AOS，帧错误控制字段用于错误检测，而接近度-1使用附加到帧（但不是帧的一部分）的循环冗余码（CRC）。帧差错控制字段在TM/TC/AOS空间数据链路协议的推荐标准中定义，而不是在同步和信道编码的推荐标准中定义。
1. TM同步和信道编码使用的循环伪噪声序列不同于TC同步和信道编码以及邻近1空间链路协议编码和同步层使用的循环伪噪声序列。
</code></pre>
<p>参考文献【33】、【34】和【32】分别概述了TM同步和信道编码、TC同步和信道编码以及邻近1空间链路协议编码和同步层的概念和原理。</p>
<h2 id="3-3-网络层"><a href="#3-3-网络层" class="headerlink" title="3.3 网络层"></a>3.3 网络层</h2><h3 id="3-3-1-网络协议的一般特征"><a href="#3-3-1-网络协议的一般特征" class="headerlink" title="3.3.1 网络协议的一般特征"></a>3.3.1 网络协议的一般特征</h3><p>CCSDS在网络层有一个接口服务：封装服务。在该服务中，有两种不同类型的数据包：在空间数据包协议中定义的__空间数据包__（参考文献[4]）和在封装服务中定义的__封装数据包__（参考文献[29]）。应该注意的是，IP over CCSDS（参考文献[45]）专门使用封装包。</p>
<p>注意–虽然空间数据包协议提供了一个可用于访问网络层的服务接口，但该服务被封装服务所包含。</p>
<p>开发空间数据包协议是为了将数据（1）从航天器上的一个源传输到地面或其他航天器上的一个或多个目的地，或（2）从地面源传输到一个或多个航天器上的一个或多个目的地。当本协议的协议数据单元穿过空间任务的数据系统（即机载网络、机载数据处理系统、地面站、控制中心）时，作为每个数据包一部分的应用程序标识符（APID）用于确定数据包将采用的路径。基于此APID，有关如何处理和转发数据包的所有决策都由管理协议设置，并且不是协议的正式部分。在交叉支援情况下，不应期望可互操作地处理APID和路径，除非已明确规定如何进行此类转发。</p>
<p>空间分组协议提供了通过涉及地对空或空对空通信链路的路径传输空间应用数据的能力。</p>
<p>通过使用封装服务，其他CCSDS认可的网络协议，如延迟容忍网络（DTN）（参考文献[55]和[56]）和IP可以在空间链路上使用。</p>
<p>空间分组协议的协议数据单元称为空间分组，而IP的协议数据单元称为IP数据报。</p>
<p>SPP和IP不提供任何用于可靠交付、顺序交付或重复抑制的QoS机制。如果需要这些功能，则必须通过更高层（如传输层）协议来实现。</p>
<p>通过空间链路，网络协议（即DTN、IP或通过SPP或封装服务承载的其他协议）的协议数据单元在空间数据链路协议内传输。</p>
<p>空间数据链路协议能够在封装分组内承载多个复用或未复用的因特网协议的协议数据单元。IP over CCSDS（参考文献[45]）规定了CCSDS识别的IP数据报如何通过链路传输。</p>
<h3 id="3-3-2-网络协议寻址"><a href="#3-3-2-网络协议寻址" class="headerlink" title="3.3.2 网络协议寻址"></a>3.3.2 网络协议寻址</h3><p>网络层协议使用两种类型的地址：路径地址和终端系统地址。</p>
<p>空间分组协议使用的路径地址标识网络中从源到一个或多个目的地的逻辑数据路径（LDP）。路径地址不是参考文献[2]中定义的地址，但CCSDS一直使用路径地址作为识别空间分组协议中逻辑连接的一种方式（参考文献[4]）。LDP的配置是通过依赖于特定用户到提供商协议和任务&#x2F;子网特定机制的管理活动完成的，而不是通过本协议的任何明确功能完成的。</p>
<p>IP和DTN使用的终端系统地址可以明确标识一个终端系统或一组终端系统。如果在使用终端系统地址时需要同时标识源地址和目标地址，则必须使用一对终端系统地址。这些地址在IP或DTN PDU中指定，IP或DTN路由节点使用这些地址在端到端路径的每一步执行路由决策。</p>
<p>如前所述，CCSDS封装服务允许在其自己的寻址类型中使用其他CCSDS识别的网络协议。</p>
<p>CCSDS正在开发延迟容忍网络（参考文献[55]和[56]），作为在中断或延迟的端到端通信环境中执行空间互操作互联网络的手段。</p>
<h2 id="3-4-传输层"><a href="#3-4-传输层" class="headerlink" title="3.4 传输层"></a>3.4 传输层</h2><p>CCSDS为传输层开发了SCPS传输协议（SCPS-TP）（参考文献[13]）。CCSDS文件交付协议（CFDP）（参考文献[15]）也提供了传输层的功能，但它也提供了应用层的一些功能（即文件管理功能）。</p>
<p>SCPS-TP支持应用程序之间的端到端通信，旨在满足广泛空间任务的需要。它定义了对TCP的扩展，并通过引用合并了UDP。它可以在空间包、封装包或IP over CCSDS上使用。</p>
<p>CFDP提供了应用层的功能（即文件管理功能），但也提供了传输层的功能。</p>
<p>互联网中使用的传输协议（如TCP，参考文献[24]和UDP，参考文献[25]）也可用于封装数据包或IP over CCSDS的空间链路。</p>
<p>IPSec（参考文献[27]）可与Internet协议套件一起使用，以提供端到端数据保护功能。</p>
<h2 id="3-5-应用层"><a href="#3-5-应用层" class="headerlink" title="3.5 应用层"></a>3.5 应用层</h2><p>CCSDS为应用层开发了五种协议：</p>
<p>​	a）异步消息服务（AMS）（参考文献[46]）；</p>
<p>​	b） CCSDS文件交付协议（CFDP）（参考文献[15]）；</p>
<p>​	c） 无损数据压缩（参考文献[16]）；</p>
<p>​	d） 图像数据压缩（参考文献[17]）；</p>
<p>​	e） 无损多光谱和高光谱图像压缩（参考文献[48]）。</p>
<p>异步消息服务（AMS）实现了一个可互操作的协议，在该协议下，任务模块、应用程序控制逻辑的不同顺序流，无论是被调用的进程、任务还是线程，都会产生和使用任务信息，可能在设计时没有明确意识到其他模块当前正在运行，也不知道它们部署在何处。</p>
<p>CFDP旨在满足空间任务传输文件的需要。它是一种文件传输协议，但它还提供通常在传输层中找到的服务，即完整、有序、无重复数据传递。它可以在网络层的任何协议（例如，空间分组协议、封装服务、IP over CCSDS）之上使用，或者如果虚拟信道、MAP、APID或端口专用于CFDP，则可以直接在TC空间数据链路协议或接近-1空间链路协议之上使用。在某些情况下，它可以在UDP、TCP或SCPS-TP之上使用。参考文献[35]概述了CFDP的概念和基本原理。</p>
<p>制定无损数据压缩标准是为了增加科学回报，减少对机载内存、站点联系时间和数据归档量的要求。该标准保证了原始数据的完整重建，而不会在重建过程中产生任何失真。它打算与空间分组协议或CFDP一起使用。参考文献[36]概述了无损数据压缩的概念和基本原理。</p>
<p>开发图像数据压缩标准是为了建立一种适用于有效载荷仪器的数字图像二维空间数据的数据压缩算法标准。根据该标准，压缩过程中使用的量化或其他近似可能导致无法在没有一些失真的情况下再现原始数据集。它打算与空间分组协议、CFDP或AOS空间数据链路协议一起使用。</p>
<p>只要底层链接足够短（&lt;1秒）且持续可用，互联网中使用的应用程序协议可以通过TCP（有或没有SCPS-TP扩展）或UDP使用。通常，编写应用程序是为了使用TCP的可靠面向流服务或UDP的不可靠数据报服务，但不能同时使用两者。然而，也存在一些例外情况，其中应用程序被编写为在任一服务上运行。</p>
<p>无损多光谱和高光谱图像压缩标准提供了一种数据压缩算法，适用于有效载荷仪器（如多光谱和高光谱成像仪）的数字三维图像数据，并指定压缩数据格式。</p>
<p>每个项目（或机构）可选择使用CCSDS不推荐的特定于应用程序的协议，以通过CCSDS空间通信协议满足其在应用层的任务要求。</p>
<h1 id="4-协议配置示例"><a href="#4-协议配置示例" class="headerlink" title="4. 协议配置示例"></a>4. 协议配置示例</h1><h2 id="4-1-总体"><a href="#4-1-总体" class="headerlink" title="4.1 总体"></a>4.1 总体</h2><p>本节举例说明了在空间数据系统中如何使用不同层次的空间通信协议。</p>
<p>本节显示了五个协议配置示例。有许多其他协议组合可用于空间数据系统，但本报告无意列举所有可能的协议组合。选择以下示例来说明空间通信协议的基本功能。</p>
<p>对于本节中的每个示例，显示了两个图表。第一张图显示了空间链路（即航天器和地面站之间或两个航天器之间的链路）上使用的协议栈。</p>
<p>空间数据系统由一个或多个机载子网、一个或多个空间链路和一个或多个地面子网组成。然而，在本节中，使用一个由四个主要元素组成的简单空间数据系统（见图4-1）来说明端到端空间数据系统中如何使用空间通信协议。将显示，一些空间通信协议用于机载和地面端系统之间的端到端通信，而一些空间通信协议仅用于空间链路上的通信。</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午7.55.58.png" alt="截屏2022-06-23 下午7.55.58" style="zoom:50%;" />

<p>本节所示的五个示例之间的主要区别在于选择用于端到端路由或转发的协议。在空间数据系统中，用户数据穿过子网（即，一个或多个机载子网、一个或多个空间链路和一个或多个地面子网）。空间数据系统中使用的协议之一提供了通过这些子网将用户数据从源路由到目标的能力。</p>
<p>此功能在本报告中称为“端到端路由”（请参阅1.3.2中“路由”和“转发”的定义）。</p>
<p>在以下示例中，以下协议用于端到端路由：</p>
<p>​	a）空间分组协议或封装服务；</p>
<p>​	b） IP over CCSDS over the封装包；</p>
<p>​	c） CFDP。</p>
<p>注</p>
<pre><code>1. 在下图中，“Prox Space Data Link Protocol”（Prox空间数据链路协议）表示接近1空间链路协议数据链路层。
1. 在下图中，为了简单起见，省略了同步和信道编码标准。
1. CCSD正在开发DTN（参考文献[55]和[56]），作为空间互联的手段。
</code></pre>
<p>##4.2 使用CCSDS定义的数据包进行端到端转发</p>
<p>在此示例中，空间分组用于端到端转发。空间数据包协议由CCSDS设计，以满足空间任务在空间链路上高效传输已处理数据的要求。这种配置适用于需要空间数据包协议提供的简单APID标记和转发功能的空间任务。</p>
<p>图4-2显示了空间链路上的协议配置示例，图4-3显示了端到端空间数据系统中的协议配置示例。在每个中间系统中，SPP协议中未指定的某种机制检查APID，并将数据转发给指示其使用的下一个节点。没有端点地址，也没有指定的互操作机制。这是由用户和服务提供商之间的管理层和外部协议完成的。</p>
<p>当空间分组协议用于端到端转发时，地面子网中的空间分组通常通过空间链路扩展（SLE）服务进行传输（见参考文献[38]–[42]）。</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午7.56.54.png" alt="截屏2022-06-23 下午7.56.54" style="zoom:33%;" />

<p>##4.3 IP over CCSDS上用于端到端路由</p>
<p>在第四个示例中，SANA中定义的一个CCSDS识别的IP数据报用于端到端路由。这种配置适用于需要端到端互联以及连接和RTLT适合支持这种方法时，需要将其空间段集成到互联网的空间任务。</p>
<p>图4-4显示了空间链路上的协议配置示例，图4-5显示了端到端空间数据系统中的协议配置示例。</p>
<p>IP的协议数据单元（数据报）通过使用IP over CCSDS协议的空间数据链路协议进行传输，以便空间数据链路协议有效地处理IP数据报。</p>
<p>在本例中，假设互联网直接扩展到空间段。大多数Internet端到端协议和SCPS-TP都可以在IP上使用。SCPS-TP可以在中继系统上转换为TCP&#x2F;UDP。</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午7.58.53.png" alt="截屏2022-06-23 下午7.58.53" style="zoom:33%;" />

<p>在IP部署的每个中间系统上，IP协议中指定的路由机制检查目标地址，并做出路由决策，将数据发送到路由中的下一个节点。端点地址是显式的，并且完全指定了用于互操作的所有机制。封装数据包提供垫片，将IP数据报插入CCSDS空间链路，并在另一端提取。</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午7.59.17.png" alt="截屏2022-06-23 下午7.59.17" style="zoom:33%;" />

<h2 id="4-4-用于端到端转发的CFDP"><a href="#4-4-用于端到端转发的CFDP" class="headerlink" title="4.4 用于端到端转发的CFDP"></a>4.4 用于端到端转发的CFDP</h2><p>在最后一个示例中，CFDP用于端到端转发。CFDP是一种文件传输协议，但它还能够通过空间数据系统转发文件。这种配置适用于大多数数据作为文件传输的空间任务。在大多数CFDP部署中，未使用Class 3和Class 4中定义的转发功能或存储转发覆盖（SFO）选项，但可能会使用。典型的部署仅使用CFDP Class 1（不可靠）或Class 2（可靠）模式，并且仅在终端节点中部署CFDP协议引擎。</p>
<p>图4-6显示了空间链路上的协议配置示例，图4-7显示了端到端空间数据系统中的协议配置示例。</p>
<p>在此示例中，假设CFDP的协议数据单元由空间分组协议或封装服务通过空间链路承载，但它们也可以通过CCSDS由IP承载。</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午8.00.07.png" alt="截屏2022-06-23 下午8.00.07" style="zoom:33%;" />

<p>图4-7显示了多个CFDP协议引擎和存储转发覆盖（SFO）的使用，是端到端转发的一个示例。在每个中间系统中，CFDP协议被终止，文件被重新组装，SFO过程用于将数据转发到下一个节点，该节点已被指示使用。这是逐跳文件传递。这是由用户和服务提供商之间的管理层和外部协议完成的。</p>
<p>CCSDS正在开发DTN网络协议（见参考文献[55]和[56]），该协议适用于近地、连接的环境以及具有长RTLT的深空或断开连接的环境。推荐使用中间跃点提供端到端文件服务的方法是通过DTN使用CFDP。在此配置中，DTN网络协议管理CFDP PDU的端到端路由和交付。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/25/CCSDS%E5%8D%8F%E8%AE%AE/" data-id="cl77bm6pp00052kfy42eddo3z" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-625weekend" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/25/625weekend/" class="article-date">
  <time class="dt-published" datetime="2022-06-24T16:49:51.907Z" itemprop="datePublished">2022-06-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="weekend"><a href="#weekend" class="headerlink" title="weekend"></a>weekend</h1><p>🏸️+🎸</p>
<p>跟师姐汇报进度。向师姐表示，不想造轮子了，太慢。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/25/625weekend/" data-id="cl77bm6pg00002kfyezjmhlk9" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CCSDS" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/23/CCSDS/" class="article-date">
  <time class="dt-published" datetime="2022-06-23T04:47:26.502Z" itemprop="datePublished">2022-06-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="CCSDS"><a href="#CCSDS" class="headerlink" title="CCSDS"></a>CCSDS</h1><ul>
<li><p>&#x3D;&#x3D;背景-内涵、历史、标准化&#x3D;&#x3D;</p>
</li>
<li><p>&#x3D;&#x3D;架构&#x3D;&#x3D;</p>
</li>
<li><p>&#x3D;&#x3D;通信协议&#x3D;&#x3D;</p>
</li>
<li><p>&#x3D;&#x3D;组网架构&#x3D;&#x3D;</p>
</li>
</ul>
<h2 id="CCSDS相关资料"><a href="#CCSDS相关资料" class="headerlink" title="CCSDS相关资料"></a>CCSDS相关资料</h2><p><a target="_blank" rel="noopener" href="https://public.ccsds.org/default.aspx">CCSDS官网</a></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Consultative_Committee_for_Space_Data_Systems">Wikipedia</a></p>
<p><a target="_blank" rel="noopener" href="https://ntrs.nasa.gov/api/citations/20150002579/downloads/20150002579.pdf">NASA_pdf</a></p>
<h3 id="CCSDS内涵、发展历史"><a href="#CCSDS内涵、发展历史" class="headerlink" title="CCSDS内涵、发展历史"></a>CCSDS内涵、发展历史</h3><h4 id="内涵"><a href="#内涵" class="headerlink" title="内涵"></a>内涵</h4><p>空间数据系统协商委员会（CCSDS）于1982年由世界上主要的空间机构组成，为讨论空间数据系统开发和运行中的共同问题提供了一个论坛。它目前由11个成员机构、32个观察员机构和超过119个工业伙伴组成。</p>
<p>自成立以来，它一直积极开发数据系统和信息系统的标准，以促进合作的空间机构之间的互操作性和交叉支持，以实现多机构的空间飞行合作（包括计划和应急）和未来任务的新能力。此外，CCSDS的标准化通过允许机构间的成本分担和具有成本效益的商业化来减少航天任务的成本负担。</p>
<p>####发展历史</p>
<p>随着在20世纪60年代和70年代太空时代的发展，人们对刺激国际合作以加强空间探索的这种方式，越来越感兴趣。特别是，由于许多空间机构在发展地面空间任务支持基础设施方面投入了大量资金，出现了 “交叉支持 “的概念，一个机构可以向另一个机构提供其数据处理服务，从而增加进行国际任务的机会。在早期，由于没有任何国际商定的空间数据标准，交叉支持通常是通过引入 “黑匣子 “适配器来处理，以便在各机构之间的接口处形成兼容性。这些黑匣子是为每个个案独特配置的。</p>
<p>随着空间探索进入20世纪80年代，航天器计算、内存和通信能力方面的技术进步，使得开始对航天器和地面数据系统交换信息的方式进行标准化是可行的。同时，实施和操作这些能力更强的空间任务的成本正在大幅增加。为了利用技术进步带来的机会和应对财政挑战，采取了一些初步措施，最终导致了空间数据系统协商委员会（CCSDS）的成立。</p>
<p>1981年3月，NASA-ESA工作组（NEWG）举行了第一次会议，讨论空间数据标准的合作发展，最初是在航天器 “分组遥测 “领域，然后是 “分组遥信”。1982年1月，在美国华盛顿特区举行的空间数据系统国际研讨会上，这一双边活动得到了扩大，世界上许多空间机构开会开始讨论与空间信息和数据系统有关的共同问题。在那次会议上，采取了最后的步骤，通过创建CCSDS来正式确定国际空间数据标准化活动，然后于1982年10月4日至8日在法国图卢兹的CNES举行了其成立会议。</p>
<p>CCSDS被授权研究交叉支持的问题，并通过其国际专家的集体努力，为交换空间任务数据的这些挑战开发先进的标准化解决方案。这些解决方案被称为CCSDS建议，是CCSDS在其最初20年的大部分时间里的主要产品。CCSDS建议草案被创建，由CCSDS参与机构审查，随后被CCSDS参与机构采纳为最终的CCSDS建议，用于指导每个成员的内部标准开发。这些早期的CCSDS活动大大加强了参与机构飞行的合作空间任务的规划和执行。</p>
<p>CCSDS最初的结构于1982年通过，以技术 “小组 “为中心，在各种空间数据系统领域制定标准建议。最初的结构是。</p>
<p>小组1 – 遥测、跟踪和指挥。<br>小组2 – 信息交换过程。<br>小组3 – 交叉支持行动。<br>小组4 – 无线电测量和轨道数据。</p>
<p>空间到地面的数据链路是CCSDS要处理的数据系统的第一部分，主要是因为它是空间任务所特有的，并受制于紧张的通信环境。基于NASA和欧空局的先驱工作，CCSDS第一小组很快提出了具体的结果，其形式是两个最终的CCSDS建议，一个是 “分组遥测”，一个是 “遥测通道编码”。第1小组迅速跟进，制定了空间信道调制、分组遥测、时间码格式的标准，并在80年代末制定了 “先进轨道系统 “标准，成为国际空间站的数据通信基准。同时，第2小组迅速制定了在科学和工程用户之间交换信息的新标准，第3小组开始制定 “空间链路扩展 “标准，允许一个机构的控制中心连接到另一个机构的地面站，第4小组制定了交换无线电计量信息的标准。</p>
<p>1991年，CCSDS与国际标准化组织（ISO）达成了一项合作安排。在这种安排下，CCSDS的建议被推进到第20技术委员会（飞机和空间飞行器）的第13小组委员会，通过正常的ISO审查和投票程序，它们被推进到正式的国际标准中。</p>
<p>2003年，在经历了20年的成功后，认识到需要精简和扩大其程序，CCSDS重新设计了该组织，采用了互联网工程任务组（IETF）成功开发地面互联网的工作模式。在新的CCSDS组织内，创建了六个广泛的学科 “领域”。</p>
<h4 id="NASA-PDF"><a href="#NASA-PDF" class="headerlink" title="NASA_PDF"></a>NASA_PDF</h4><h5 id="一、-CCSDS背景"><a href="#一、-CCSDS背景" class="headerlink" title="一、 CCSDS背景"></a>一、 CCSDS背景</h5><p>######重要信息</p>
<p>这项工作必须在新项目开始之前完成。<br>当新项目有了明确的要求时，他们的道路已经确定，他们不会等待新标准的制定。<br>他们只采用项目开始时可用的标准。<br>目前，为即将到来的尚未制定的国际任务做好准备至关重要</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午1.26.43.png" alt="截屏2022-06-23 下午1.26.43" style="zoom:33%;" />

<p>新任务有新的通信需求，新的技术迅速改变行业</p>
<p>因此需要一个，&#x3D;&#x3D;快速响应&#x3D;&#x3D;的标准化组织是&#x3D;&#x3D;前所未有的重要的&#x3D;&#x3D;。</p>
<h6 id="CCSDS的范围和起源"><a href="#CCSDS的范围和起源" class="headerlink" title="CCSDS的范围和起源"></a>CCSDS的范围和起源</h6><p>CCSDS&#x3D;空间数据系统咨询委员会</p>
<p>通信和数据系统标准化</p>
<p>自1982年起，从协议栈的较低层开始，现在：贯穿整个ISO通信堆栈；以及其他数据系统领域（体系结构、归档、安全、XML、交换格式等）；任何业务的端到端数据&#x2F;通信架构</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午1.32.11.png" alt="截屏2022-06-23 下午1.32.11" style="zoom:33%;" />

<p>#####二、 CCSDS结构、组织、流程</p>
<h6 id="CCSDS标准化"><a href="#CCSDS标准化" class="headerlink" title="CCSDS标准化"></a>CCSDS标准化</h6><p>当一个新技术被迅速引入到一个标准社区中，其被更大的用户群审查，从而促进创新技术的广泛应用。</p>
<p>通过更多人的审查“more eyes on the problem”，减少了新技术的风险</p>
<p>将技术开发成本分散到更大的用户群。</p>
<p>使联合任务能够分担开销、增加容量。</p>
<p>通过熟悉的接口和更多的应急恢复选项，改善了操作。</p>
<p><del>谬论</del>：标准扼杀了创新</p>
<p>__事实__：CCSDS通过接触更广泛的社区论坛，采用、调整、发展和巩固创新，促进先进技术的发展</p>
<p><del>谬论</del>：标准推迟实施</p>
<p>__事实__：如果早期将创新纳入标准流程，则不会。推迟是因为不愿意标准化，而不是因为标准化</p>
<h6 id="CCSDS-总览-参与"><a href="#CCSDS-总览-参与" class="headerlink" title="CCSDS 总览 - 参与"></a>CCSDS 总览 - 参与</h6><p>由机构领导的国际委员会</p>
<p>目前有11个成员机构</p>
<p>29个观察员机构</p>
<p>27个国家（3个欧洲组织）</p>
<p>目前有108家商业联营公司</p>
<p>160-180人参加春季&#x2F;秋季会议</p>
<p>还担任ISO小组委员会</p>
<p>TC20&#x2F;sc13 - 空间数据 &amp; 信息传输系统</p>
<p>代表20个国家</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午2.00.15.png" alt="截屏2022-06-23 下午2.00.15" style="zoom:33%;" />

<h6 id="CCSDS总览"><a href="#CCSDS总览" class="headerlink" title="CCSDS总览"></a>CCSDS总览</h6><p>当前有效出版：135</p>
<p>标准的（蓝色和品红）：85</p>
<p>教育性的、信息的（绿色）：52</p>
<p>自1982年以来，所有主要出版约有285（其中一些是历史使命需求或被取代的技术）</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午2.04.36.png" alt="截屏2022-06-23 下午2.04.36" style="zoom:33%;" />

<p>718项空间任务采用并使用了各种CCSDS标准</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午2.04.59.png" alt="截屏2022-06-23 下午2.04.59" style="zoom:33%;" />

<h6 id="CCSDS总览-组织相互关系"><a href="#CCSDS总览-组织相互关系" class="headerlink" title="CCSDS总览 - 组织相互关系"></a>CCSDS总览 - 组织相互关系</h6><p>IOAG向CCSDS提供IOAG优先级和未来通信&#x2F;运营计划指南</p>
<p>CCSDS参与者带来了其他机构&#x2F;行业投入、任务需求和技术驱动因素。</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午2.16.16.png" alt="截屏2022-06-23 下午2.16.16" style="zoom:33%;" />

<h6 id="一些组织相互关系"><a href="#一些组织相互关系" class="headerlink" title="一些组织相互关系"></a>一些组织相互关系</h6><p>OMG：对象管理组，供应商产品间应用程序信息交换的行业标准，CCSDS&#x2F;OMG有一些共同标准和定期联席会议。</p>
<p>IETF：互联网工程任务组<br>IRTF：互联网研究工作组<br>IP套件和DTN的开放式国际标准，CCSDS尽可能使用此类行业标准作为基础</p>
<p>ECSS：欧洲空间标准联合会-欧洲空间任务支持区域标准，CCSDS&#x2F;ECSS协调兼容标准</p>
<p>AIAA：美国航空航天学会，北美空间任务支持区域标准。区域标准协调，AIAA为CCSDS、ISO TC20&#x2F;SC13和SC14提供秘书处支持<br>#####三、 关注对ALTEC有兴趣的工作组</p>
<h6 id="CCSDS总览-端到端结构"><a href="#CCSDS总览-端到端结构" class="headerlink" title="CCSDS总览 - 端到端结构"></a>CCSDS总览 - 端到端结构</h6><p>六个技术区域，二十六个团队：工作组（制定标准），羽翼未丰阶段（预批准），特别兴趣组（整合论坛）</p>
<p>典型任务简介：</p>
<p>__系统工程__：安全、Delta-DOR、时间线数据交换、XML标准和指南</p>
<p>__航天器机载接口服务__：机载无线工作组、应用程序支持服务</p>
<p>__空间链路服务__：射频&amp;调制、空间链路编码&amp;同步、超&#x2F;多数据压缩、空间链路协议、下一代上行链路、空间数据链路安全、光学编码和调制</p>
<p>__交叉支持服务__：交叉支持服务管理、交叉支持传输服务、横向支撑服务拱。</p>
<p>__空间互联网服务__：运动图像和应用程序、延迟容忍网络、声音、Encap上CFDP、CFDP修订</p>
<p>__任务运行与信息管理服务__：数据存档摄取、航行、航天器监视&amp;控制、数字存储库审核&#x2F;认证、远程机器人技术</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午2.24.18.png" alt="截屏2022-06-23 下午2.24.18" style="zoom:33%;" />

<h6 id="CCSDS结构和组织"><a href="#CCSDS结构和组织" class="headerlink" title="CCSDS结构和组织"></a>CCSDS结构和组织</h6><img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午2.59.57.png" alt="截屏2022-06-23 下午2.59.57" style="zoom:33%;" />

<h6 id="CCSDS与ISO的关系"><a href="#CCSDS与ISO的关系" class="headerlink" title="CCSDS与ISO的关系"></a>CCSDS与ISO的关系</h6><img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午3.01.13.png" alt="截屏2022-06-23 下午3.01.13" style="zoom:33%;" />

<p>######CCSDS技术组织：</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午3.04.33.png" alt="截屏2022-06-23 下午3.04.33" style="zoom:33%;" />

<p>六个技术区域</p>
<img src="/Users/sunzekun/Library/Application Support/typora-user-images/截屏2022-06-23 下午3.04.51.png" alt="截屏2022-06-23 下午3.04.51" style="zoom:33%;" />

<h6 id="工作组"><a href="#工作组" class="headerlink" title="工作组"></a>工作组</h6><ol>
<li>安全工作组<ul>
<li>安全是一项重要的任务。该小组处理CCSDS的安全上行链路指令（认证、完整性、保密性）、安全下行链路遥测（保密性、完整性）和科学数据隐私（保密性、认证、完整性）的协议。<br> 为CCSDS工作组在其他CCSDS工作组中，考虑安全因素和做法，提供安全建议和指导。</li>
<li>已开发并准备应用的文件（共10个）。<br>   关于在CCSDS中使用安全的绿皮书<br>   空间数据系统的安全架构<br>   CCSDS加密算法和认证算法<br>   系统互连指南<br>   任务规划师的安全指南</li>
<li>正在进行的工作。密钥管理指南和标准、威胁指南、网络层、安全概况</li>
<li>即将召开的会议的主要目标<br>   审查密钥管理文件的进展<br>   讨论网络层安全测试进展<br>   讨论和审查威胁绿皮书修订版的变化</li>
</ul>
</li>
<li>XML标准化和指导工作组<ul>
<li>CCSDS有许多工作组在其标准中发布XML规范</li>
<li>在关于如何表示上产生的分歧，给实施者带来了混乱</li>
<li>XSG 工作组计划统一这些表述，以防止这种分歧。</li>
</ul>
</li>
<li>数据存档摄取工作组<ul>
<li>DAI工作组。<br>   开发获取、摄取、保存和访问档案信息的标准化方法，重点是长期保存方法。<br>   与存储库审计和认证（RAC）工作组紧密合作 </li>
<li>最近完成的文件<br>   开放档案信息系统（OAIS）的参考模型<br>   世界范围内最广泛认可和引用的数字归档标准<br>   最受欢迎的CCSDS文件<br>   生产者-档案录入方法抽象标准（PAIMAS）<br>   将数据录入档案的阶段和步骤的检查表<br>   生产者-档案录入规范(PAIS)<br>   用于建模的格式，然后执行生产者和档案馆之间的传输<br>       最近完成的CCSDS标准，相当于ISO的标准正在投票中，帮助用户应用标准的教程正在进行中。</li>
<li>开发中的文件<br>   信息保存过程<br>   旨在详细说明从最初的任务规划，到数据生成、信息开发和最终归档的信息保存问题。<br>   以欧盟地球观测团体长期数字保存项目的工作为基础。</li>
</ul>
</li>
<li>航行工作组<ul>
<li>CCSDS导航工作组被授权制定涉及空间飞行动力学相关数据交换的标准。</li>
<li>过去的进展和当前的工作<br>   轨道数据信息（2.0版，2009年11月发布）<br>   用于交换轨道描述的三种标准信息格式<br>   追踪数据信息（1.0版，2007年11月发布）。<br>   用于交换跟踪数据的消息格式；支持广泛使用的跟踪数据类型。多普勒、范围、角度、∆DOR、辅助信息<br>   姿态数据消息（1.0版，2008年5月发布）<br>   两种用于交换航天器姿态描述的消息格式<br>   导航绿皮书（3.0版，2010年5月发布）<br>   包含与导航工作组建议相关的技术背景<br>   导航数据信息XML规范（1.0版，2010年12月发布）<br>   包含上述所有导航工作组标准的XML表示。<br>   联接数据信息（2013年6月发布）<br>   用于通知航天器操作人员空间物体结合的标准信息格式 的标准信息格式（航天器&#x2F;航天器，航天器&#x2F;碎片，碎片&#x2F;碎片）。</li>
<li>未来的工作<br>   指向请求消息–交流复杂的在轨交叉支持指向请求（例如，惯性、边缘、终结者、速度、天底、轨道）。<br>   导航硬件信息–在空间机构之间交换机载导航H&#x2F;W数据（如推进器、加速计、星际跟踪器等）。<br>   航天器操纵信息–交换有关航天器操纵的信息（要求、设计、重建性能）。</li>
</ul>
</li>
<li>飞行器监管与控制工作组<ul>
<li>重点是在应用层面上对每个任务中的共同功能的服务接口进行标准化。<br>   早期的重点是地对地接口<br>   也开始测试飞行系统接口<br>   承诺即插即用的服务接口，机上应用程序的迁移 </li>
<li>利用业界公认的SOA（面向服务的架构）方法。<br>   使服务提供者和消费者的互动标准化<br>   包括服务的发现（自动配置接口）。<br>   即插即用的特点。最终允许运营&#x2F;管理决策独立于软件开发项目之外<br>   提供应用的可移植性以及互操作性</li>
<li>最新进展<br>   基本框架（消息抽象层等）已经发布。<br>   第一个应用，Mon&#x2F;Ctrl（TLM&#x2F;CMD）在机构审查中<br>   警报（警报限制等）目前在审查周期中<br>   正在研究几种语言的绑定和传输的绑定</li>
<li>新的发展：IOAG成立了MOSSG小组委员会来审查 CCSDS MO服务方法，并创建一个IOAG服务目录<br>   MOSSG &#x3D; Mission Ops Systems Strategy Group</li>
</ul>
</li>
<li>远程机器人工作组<ul>
<li>目标：为空间远程机器人技术开发和运营社区，制定兼容层的规范，允许操作员和机器人代理自由交换信息，使操作员能够以统一的方式与异质机器人进行通信。</li>
<li>现在只有绿色（信息性）书在工作中，但工作计划是蓝色（规范性）协议规范。</li>
</ul>
</li>
<li>跨越式空间通讯建筑工作组<ul>
<li>开发 “大画面 “描述，以指导CCSDS通信交叉支持的架构。</li>
<li>确定CCSDS的许多标准是如何结合在一起的</li>
<li>产品<br>   已完成：交叉支持架构概念和理论依据绿色（信息）书<br>   现在机构审查中。空间交叉支持通信架构要求文件<br>   品红色（规范性）书籍 - 推荐做法</li>
</ul>
</li>
<li>SOIS应用支持工作组<ul>
<li>为机载航空电子设备开发标准化的分层服务接口以促进互操作性<br>   支持和参考下层链接服务，但目前只指向那些外部标准（SpaceWire、1553等）。<br>   现在更具体的是，协调空间组件（硬件和软件组件）之间的接口控制文件（ICD）。</li>
<li>目前的目标<br>   规范电子数据表（EDS）的XML模式<br>   需要开发通用组件，以实现不同供应商之间组件的互操作性和易集成性<br>   开发术语词典（DOT）书<br>   需要定义SOIS EDS组件的通用术语</li>
<li>最近的发展：将机载链路（总线）标准纳入CCSDS进行标准化的一些建议<br>   RapidIO</li>
</ul>
</li>
<li>空间链路协议工作组<ul>
<li>目标：改编或开发用于空间的链路层协议，包括近地、深空、接近环境。</li>
<li>新的努力：先进的空间链接协议，将结合并超越TM、TC和Prox-1的功能<br>   为更高的容量（光通信）、Cislunar环境等 “修复 “传统CCSDS协议。<br>   下一代空间链路协议<br>   统一空间链路协议</li>
<li>下一次会议：就统一SLP绿皮书草案达成共识。</li>
</ul>
</li>
<li>空间数据链路安全工作组</li>
</ol>
<ul>
<li>目标：为在CCSDS空间链路的数据链路层运行的安全协议制定一项建议。该安全协议应该为上行链路和下行链路提供认证和&#x2F;或加密，并且它应该独立于任何特定的加密算法。</li>
<li>工作计划。<br>   制定CCSDS链路层安全标准协议（蓝皮书），与现有的CCSDS链路层（TM、TC、AOS）以及未来的链路层协议（统一SLP）一起工作。<br>   为了支持这一点，还将制定绿皮书（信息性）和黄皮书（测试）。</li>
<li>下次会议：关于密钥管理、安全控制指令、扩展程序的工作</li>
</ul>
<ol start="11">
<li>运动图像和应用程序工作组</li>
</ol>
<ul>
<li>目标。合作机构的数字视频系统之间的互操作性。<br>   NDSC, PALS, SECAM等的历史问题。<br>   种类繁多的新数字视频标准。需要向下选择支持空间作业的子集。</li>
<li>支持绿皮书（资料性）已经出版</li>
<li>正在编写蓝皮书（规范性）。<br>   一般会指向具有商业实施的外部标准，而不是开发新的格式</li>
<li>下一次会议的计划重点是完成对蓝皮书的最后一次审查和制定测试报告。</li>
</ul>
<ol start="12">
<li>时延容忍网络工作组</li>
</ol>
<ul>
<li>DTN工作组正在为太阳系互联网（SSI）打下基础<br>   在太空中提供自动路由（如地面互联网），但与目前的IP技术相比。<br>   为深空环境增加了延时&#x2F;中断容忍度<br>   在受干扰的近地环境中提供更多的数据，更快。</li>
<li>过去的进展和当前的工作<br>   SSI架构文件和原理绿皮书已经出版。<br>   DTN捆绑协议（BP）规范和LTP传输协议（Licklider）蓝皮书即将完成</li>
<li>未来的工作 - 完整的太阳系互联网（SSI）基础设施，包括<br>   网络管理<br>   接触图路由<br>   文件传输协议（CFDP）的重构</li>
<li>爆炸性新闻。IETF将DTN作为地面互联网的标准</li>
</ul>
<ol start="13">
<li>其他工作区域</li>
</ol>
<ul>
<li>规划系统（伦敦会议的BOF）。<br>力求为机器人和载人航天项目的任务运行规划数据交换开发标准化接口。</li>
<li>机载无线工作组<br>无线机载通讯可减轻发射重量。</li>
</ul>
<p>#####四、 CCSDS线上资源<br><a href="www.CCSDS.org">线上资源1</a><br><a href="CWE.CCSDS.org">线上资源2</a></p>
<p>#####五、 总结</p>
<ul>
<li>最后的信息。仍有许多工作要做<br>   实现国际机构之间的互操作性 未来的任务–包括地球-轨道和探索任务。<br>   远景–地球轨道和深空任务的自动路由和耐延迟网络。包括航天器和地面系统之间的交叉连接。<br>   近期需求–维持与其他机构的交叉支持协议的演进方式。</li>
<li>与空间任务的未来有利害关系的组织，以及具有为CCSDS做出贡献的专业知识的组织应该参与进来。</li>
</ul>
<h3 id="CCSDS空间通信协议参考模型"><a href="#CCSDS空间通信协议参考模型" class="headerlink" title="CCSDS空间通信协议参考模型"></a>CCSDS空间通信协议参考模型</h3><p>![image-20220623164740017](&#x2F;Users&#x2F;sunzekun&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220623164740017.png)</p>
<p>###CCSDS空间通信协议</p>
<p>![image-20220623164748351](&#x2F;Users&#x2F;sunzekun&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220623164748351.png)</p>
<h3 id="CCSDS典型协议介绍"><a href="#CCSDS典型协议介绍" class="headerlink" title="CCSDS典型协议介绍"></a>CCSDS典型协议介绍</h3><ul>
<li><p>Space Internetworking Services Area</p>
<p>CCSDS 702.1-B-1 IP over CCSDS Space Links</p>
<p>CCSDS 720.1-G-4 CCSDS File Delivery Protocol (CFDP)</p>
<p>CCSDS 766.2-B-1 Voice and Audio Communications</p>
</li>
</ul>
<h3 id="基于CCSDS的典型卫星组网架构"><a href="#基于CCSDS的典型卫星组网架构" class="headerlink" title="基于CCSDS的典型卫星组网架构"></a>基于CCSDS的典型卫星组网架构</h3><ul>
<li>产业界</li>
<li>学术界</li>
<li>特征描述及介绍</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/23/CCSDS/" data-id="cl77bm6pk00012kfy10ojg9k7" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-选路" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/07/%E9%80%89%E8%B7%AF/" class="article-date">
  <time class="dt-published" datetime="2022-06-07T07:55:21.764Z" itemprop="datePublished">2022-06-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>#0.文件说明</p>
<p>input.py:输入的参数</p>
<p>Linklist.py:定义的数据结构，如流的曲线、流的参数等</p>
<p>SatTopo_update.py:定义了在main函数中需要用到的函数，找路、映射流、判断是否能映射等</p>
<p>main.py:主函数，运行主函数，将进行一个默认2000条流，每条流找5条路径进行传输的映射。</p>
<p>#1.流程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">A[\读取txt\]--&gt;B(得到拓扑)</span><br><span class="line">B--&gt;C&#123;选中传输流&#125;</span><br><span class="line">C--&gt;K(获取符合条件的拓扑)</span><br><span class="line">K--&gt;D(获取K条路径)</span><br><span class="line">D--Yes--&gt;G(采取路径传输flow)</span><br><span class="line">D--No--&gt;C</span><br><span class="line">G--&gt;H&#123;判断符合需求&#125;</span><br><span class="line">H--Yes--&gt;I(放入路径集)</span><br><span class="line">I--&gt;J(选择开销最小路径来传输)</span><br><span class="line">J--&gt;C</span><br></pre></td></tr></table></figure>

<p>#2.判断路径是否符合要求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">A[\输入拓扑and路径and流\]--&gt;B(复制拓扑and初始化函数内参数)</span><br><span class="line">B--&gt;D(将流根据路径映射进拓扑中,并更新网络拓扑)</span><br><span class="line">D--&gt;E(根据更新后的拓扑的到达曲线,沿路径逐跳更新带宽和缓存,并判断是否符合带宽and缓存要求)</span><br><span class="line">E--&gt;F(根据获得的链路到达曲线计算出开销)</span><br><span class="line">F--&gt;G[\返回结果\]</span><br></pre></td></tr></table></figure>

<p>##2.1更新网络拓扑</p>
<p>###2.1.1获得每个链路的到达曲线</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 遍历每个上游链路，1.将某一上游链路流入到此链路的流求和，2.计算收到物理限制的求和流，3.遍历另一个上游链路，跳回步骤1</span></span><br><span class="line"><span class="comment"># 以上操作在computeAllInFlow函数中实现</span></span><br><span class="line">tempInCurve = computeAllInFlow(topo, this_node, class_node, nxt_node)</span><br></pre></td></tr></table></figure>

<p>###2.1.2将已经映射到拓扑中的链路保存在链路的进入曲线In_Curve中,包含信息：此流的上游链路、此流的下游链路、流信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tempInFlow = &#123;<span class="string">&#x27;priNode&#x27;</span>: pre_class_node, <span class="string">&#x27;thisNode&#x27;</span>: this_node,</span><br><span class="line">            <span class="string">&#x27;classNode&#x27;</span>: class_node, <span class="string">&#x27;nxtNode&#x27;</span>: nxt_node, <span class="string">&#x27;flow&#x27;</span>: tempFlow&#125;</span><br><span class="line">topo[class_node][nxt_node][<span class="string">&#x27;In_Curve&#x27;</span>].insert(tempInFlow, topo[class_node][nxt_node][<span class="string">&#x27;In_Curve&#x27;</span>].size)</span><br></pre></td></tr></table></figure>

<p>####1）其中tempFlow保存着映射流flowInCurve的斜率和缓存消息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tempFlow.insert(&#123;<span class="string">&#x27;r&#x27;</span>: flow_selected[<span class="string">&#x27;r&#x27;</span>],</span><br><span class="line">                 <span class="string">&#x27;b&#x27;</span>: flowInCurve.subs(<span class="number">0</span>)&#125;, tempFlow.size)</span><br></pre></td></tr></table></figure>

<p>####2）flowInCurve初始化为输入流的斜率r与截距b</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inputFlowCurve = curveInterval(flow_selected[<span class="string">&#x27;r&#x27;</span>], flow_selected[<span class="string">&#x27;b&#x27;</span>], <span class="number">0</span>, max_time)</span><br><span class="line">flowInCurve = curveFull()</span><br><span class="line">flowInCurve.addAnotherCurveOneInterval(inputFlowCurve)</span><br></pre></td></tr></table></figure>

<p>####3）之后每经过一跳，会根据CBS服务时间增大截距b（突发）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flowInCurve.addBAll(compute_nodes_T_buffer</span><br><span class="line">                      (flowInCurve, topo[this_node][class_node][<span class="string">&#x27;T&#x27;</span>])-flowInCurve.subs(<span class="number">0</span>))</span><br></pre></td></tr></table></figure>

<p>在映射流到路径中的下一链路时，则将更新后的flowInCurve映射进入</p>
<h3 id="2-1-3更新网络拓扑"><a href="#2-1-3更新网络拓扑" class="headerlink" title="2.1.3更新网络拓扑"></a>2.1.3更新网络拓扑</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上游链路受到物理限制的输出曲线之和便是此链路的到达曲线，更新进网络拓扑topo[class_node][nxt_node][&#x27;Out_Curve&#x27;]中</span></span><br><span class="line">topo[class_node][nxt_node][<span class="string">&#x27;Out_Curve&#x27;</span>] = tempInCurve</span><br></pre></td></tr></table></figure>

<p>其中tempInCurve由2.1.1小节获得</p>
<h2 id="2-2其余工作"><a href="#2-2其余工作" class="headerlink" title="2.2其余工作"></a>2.2其余工作</h2><p>###1）造轮子，如记录曲线的数据结构curveFull、只记录流特征值（斜率和截距or突发）的数据结构flows、记录流映射（从所有上游链路映射到此链路的流与流的属性）的数据结构inFlow，省略介绍。</p>
<p>###2）计算缓存、判断是否符合需求、计算开销等，省略介绍。</p>
<h1 id="3-使用说明"><a href="#3-使用说明" class="headerlink" title="3.使用说明"></a>3.使用说明</h1><p>##3.1 input文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Mbit unit</span></span><br><span class="line">Mbit = <span class="number">1000000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CBS metrics</span></span><br><span class="line">L_ij_E = <span class="number">0.012</span> * Mbit  <span class="comment"># packet length 1.5KB</span></span><br><span class="line">L_ij_A = <span class="number">0.012</span> * Mbit</span><br><span class="line">L_ij_B = <span class="number">0.012</span> * Mbit</span><br><span class="line">_L_ij_A = <span class="number">0.012</span> * Mbit  <span class="comment"># maximum packet length 1.5KB</span></span><br><span class="line">max_packet_length = <span class="number">0.012</span> * Mbit</span><br><span class="line">b_ij = <span class="number">0.012</span> * Mbit  <span class="comment"># flow`s buffer</span></span><br><span class="line">I_ij_A = <span class="number">240</span> * Mbit  <span class="comment"># CBS Idleslope for class A 30MB</span></span><br><span class="line">I_ij_B = <span class="number">60</span> * Mbit  <span class="comment"># CBS Idleslope for class B 7.5MB</span></span><br><span class="line">S_ij_A = -<span class="number">1360</span> * Mbit  <span class="comment"># CBS Sendslope for class A 170MB</span></span><br><span class="line">S_ij_B = -<span class="number">1540</span> * Mbit  <span class="comment"># CBS Sendslope for class B 192.5MB</span></span><br><span class="line">c_ij = <span class="number">1600</span> * Mbit  <span class="comment"># physical rate 200MB</span></span><br><span class="line">r_ij = <span class="number">80</span> * Mbit  <span class="comment"># CDT rate 10MB</span></span><br><span class="line">R_ij_A = I_ij_A * (c_ij - r_ij) / (I_ij_A - S_ij_A)</span><br><span class="line">T_ij_A = <span class="number">1</span> / (c_ij - r_ij) * (_L_ij_A + b_ij + r_ij * _L_ij_A / c_ij)</span><br><span class="line">R_ij_B = I_ij_B * (c_ij - r_ij) / (I_ij_B - S_ij_B)</span><br><span class="line">T_ij_B = <span class="number">1</span> / (c_ij - r_ij) * (L_ij_E + L_ij_A - I_ij_A * _L_ij_A / S_ij_A + b_ij + r_ij * _L_ij_A / c_ij)</span><br><span class="line"></span><br><span class="line"><span class="comment"># topo metrics</span></span><br><span class="line">file_path = <span class="string">&quot;SatTopo.txt&quot;</span></span><br><span class="line">r_earth = <span class="number">6371393</span>  <span class="comment"># earth radius 6371km</span></span><br><span class="line">h_sat = <span class="number">600000</span>  <span class="comment"># satellite`s height</span></span><br><span class="line">sat_of_one_orbit = <span class="number">11</span>  <span class="comment"># satellite number of orbit</span></span><br><span class="line">num_of_orbit = <span class="number">6</span>  <span class="comment"># orbit number</span></span><br><span class="line">c_speed = <span class="number">300000000</span>  <span class="comment"># 3*10^8 m/s</span></span><br><span class="line">sat_buffer = <span class="number">1</span> * Mbit  <span class="comment"># sat`s buffer</span></span><br><span class="line">sat_bandwidth = <span class="number">1600</span> * Mbit  <span class="comment"># sat`s bandwidth</span></span><br><span class="line"></span><br><span class="line">simulation_time = <span class="number">10</span>  <span class="comment"># duration time 10s</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># flow metrics</span></span><br><span class="line">num_of_flow = <span class="number">500</span>  <span class="comment"># simulate 200 flows</span></span><br><span class="line">r_flow = <span class="number">0.08</span> * Mbit  <span class="comment"># flow`s r f=r(t)+b</span></span><br><span class="line">b_flow = <span class="number">0.04</span> * Mbit  <span class="comment"># flow`s b</span></span><br><span class="line">maxdelay_flow = <span class="number">0.5</span>  <span class="comment"># flow`s max delay</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># find K paths for one flow</span></span><br><span class="line">num_of_find_K_path = <span class="number">5</span>  <span class="comment"># find 3 path for each flow</span></span><br></pre></td></tr></table></figure>

<p>在input.py文件中，调整CBS、flow、拓扑、找路数量的参数</p>
<h2 id="3-2-main-py"><a href="#3-2-main-py" class="headerlink" title="3.2 main.py"></a>3.2 main.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> SatTopo_update <span class="keyword">import</span> init_topo, get_satisfied_topo, get_k_delay_path, get_delay, flow_init, judge_path_for_flow_in_topo, init_flow_matrix</span><br><span class="line"><span class="keyword">from</span> <span class="built_in">input</span> <span class="keyword">import</span> file_path, sat_bandwidth, sat_buffer, sat_of_one_orbit, num_of_orbit, num_of_flow, r_flow, b_flow, maxdelay_flow, num_of_find_K_path</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">start = time.clock()</span><br><span class="line"><span class="comment"># 1.Get Topo</span></span><br><span class="line">sat_topo = init_topo(file_path, <span class="number">1</span>, sat_buffer, sat_bandwidth)</span><br><span class="line">source_node = np.random.randint(<span class="number">1</span>, sat_of_one_orbit * num_of_orbit + <span class="number">1</span>)</span><br><span class="line">target_node = np.random.randint(<span class="number">1</span>, sat_of_one_orbit * num_of_orbit + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.Initiate flows</span></span><br><span class="line">Flow = flow_init(flow_number=num_of_flow, r=r_flow, b=b_flow, delay=maxdelay_flow)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flow : &quot;</span>, Flow)</span><br><span class="line">flow_succses = <span class="number">0</span></span><br><span class="line">flow_count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> flow_count &lt; <span class="built_in">len</span>(Flow):</span><br><span class="line">    flow_selected = Flow[flow_count]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------new flow :&quot;</span>, flow_selected, <span class="string">&quot;--------------&quot;</span>)</span><br><span class="line">    <span class="comment"># 3.Get K paths and determine</span></span><br><span class="line">    <span class="comment"># 获取满足传输流需求的临时拓扑，在这个临时拓扑上找路径</span></span><br><span class="line">    satisfied_topo = get_satisfied_topo(sat_topo, flow_selected)</span><br><span class="line">    <span class="comment"># 在临时拓扑上找路径，则路径符合端到端时延要求和带宽需求</span></span><br><span class="line">    path = get_k_delay_path(satisfied_topo, flow_selected[<span class="string">&#x27;Source&#x27;</span>],</span><br><span class="line">                            flow_selected[<span class="string">&#x27;Target&#x27;</span>], K=num_of_find_K_path, max_delay=flow_selected[<span class="string">&#x27;maxDelay&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;path：&quot;</span>, path)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Length of Path : &quot;</span>, <span class="built_in">len</span>(path))</span><br><span class="line">    <span class="comment"># 4.然后判断路径是否满足缓存需求</span></span><br><span class="line">    path_count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(path) &gt; <span class="number">0</span>:</span><br><span class="line">        path_set = []</span><br><span class="line">        <span class="keyword">while</span> path_count &lt; <span class="built_in">len</span>(path):</span><br><span class="line">            <span class="built_in">print</span>(path[path_count])</span><br><span class="line">            [class_a_topo_2, cost, can_trans] = judge_path_for_flow_in_topo \</span><br><span class="line">                (sat_topo, path[path_count], flow_selected, <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">if</span> can_trans == <span class="number">1</span>:</span><br><span class="line">                <span class="comment"># 添加这个路径和此路径的花费</span></span><br><span class="line">                path_set.append(&#123;<span class="string">&quot;path&quot;</span>: path[path_count], <span class="string">&quot;cost&quot;</span>: cost&#125;)</span><br><span class="line">            path_count += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;cost is :&quot;</span>, cost, <span class="string">&quot;can trans ? &quot;</span>, can_trans)</span><br><span class="line">            <span class="comment"># 5.将符合条件的路径添加到路径集当中</span></span><br><span class="line">        <span class="comment"># 选择路径集中开销最小的路径，作为传输的路径</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(path_set) &gt; <span class="number">0</span>:</span><br><span class="line">            path_set = <span class="built_in">sorted</span>(path_set, key=<span class="keyword">lambda</span> x: x[<span class="string">&#x27;cost&#x27;</span>])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;All path and cost:&quot;</span>, path_set)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;minimum cost path&quot;</span>, path_set[<span class="number">0</span>])</span><br><span class="line">            [sat_topo_2, cost, can_trans] = judge_path_for_flow_in_topo \</span><br><span class="line">                (sat_topo, path_set[<span class="number">0</span>][<span class="string">&#x27;path&#x27;</span>], flow_selected, <span class="number">1</span>)</span><br><span class="line">            sat_topo = sat_topo_2</span><br><span class="line">            flow_succses += can_trans  <span class="comment"># 此流映射成功，flow_succses+1</span></span><br><span class="line">    flow_count += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flow_succses)</span><br><span class="line"></span><br><span class="line">end = time.clock()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;running time: &quot;</span>, end-start)</span><br></pre></td></tr></table></figure>

<p>直接运行main.py文件即可。</p>
<h2 id="3-3-测试运行结果"><a href="#3-3-测试运行结果" class="headerlink" title="3.3 测试运行结果"></a>3.3 测试运行结果</h2><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4he3u7dxlj21g30u07bz.jpg" alt="截屏2022-07-24 上午1.44.34"></p>
<p>选择的传输路径为[43,175,32,164,21,153,22,154,12,78,1,67,2,134,69,4,70,5]</p>
<p>第一跳、第二跳…的曲线信息(斜率r、截距b、时间段t0t1)如图中所示。</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4he3xttlqj21h90u07fd.jpg" alt="截屏2022-07-24 上午1.44.10"></p>
<p>本次仿真映射了2000条流，总共花了887s，映射成功1998条流，因为映射流后网络拓扑存储的数据会变多。因此映射的流越多，运行时间越长。</p>
<h2 id="3-4-需要更改networkx中shortest-simple-paths的源码，取出找不到路径后的异常抛出"><a href="#3-4-需要更改networkx中shortest-simple-paths的源码，取出找不到路径后的异常抛出" class="headerlink" title="3.4 需要更改networkx中shortest_simple_paths的源码，取出找不到路径后的异常抛出"></a>3.4 需要更改networkx中shortest_simple_paths的源码，取出找不到路径后的异常抛出</h2><p>直接把以下代码全部替换源文件，其实只改了几行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> heapq <span class="keyword">import</span> heappush, heappop</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> count</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> networkx <span class="keyword">as</span> nx</span><br><span class="line"><span class="keyword">from</span> networkx.utils <span class="keyword">import</span> not_implemented_for</span><br><span class="line"><span class="keyword">from</span> networkx.utils <span class="keyword">import</span> pairwise</span><br><span class="line"><span class="keyword">from</span> networkx.utils <span class="keyword">import</span> empty_generator</span><br><span class="line"><span class="keyword">from</span> networkx.algorithms.shortest_paths.weighted <span class="keyword">import</span> _weight_function</span><br><span class="line"></span><br><span class="line">__all__ = [</span><br><span class="line">    <span class="string">&quot;all_simple_paths&quot;</span>,</span><br><span class="line">    <span class="string">&quot;is_simple_path&quot;</span>,</span><br><span class="line">    <span class="string">&quot;shortest_simple_paths&quot;</span>,</span><br><span class="line">    <span class="string">&quot;all_simple_edge_paths&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_simple_path</span>(<span class="params">G, nodes</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns True if and only if `nodes` form a simple path in `G`.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    A *simple path* in a graph is a nonempty sequence of nodes in which</span></span><br><span class="line"><span class="string">    no node appears more than once in the sequence, and each adjacent</span></span><br><span class="line"><span class="string">    pair of nodes in the sequence is adjacent in the graph.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    nodes : list</span></span><br><span class="line"><span class="string">        A list of one or more nodes in the graph `G`.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns</span></span><br><span class="line"><span class="string">    -------</span></span><br><span class="line"><span class="string">    bool</span></span><br><span class="line"><span class="string">        Whether the given list of nodes represents a simple path in `G`.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Notes</span></span><br><span class="line"><span class="string">    -----</span></span><br><span class="line"><span class="string">    An empty list of nodes is not a path but a list of one node is a</span></span><br><span class="line"><span class="string">    path. Here&#x27;s an explanation why.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This function operates on *node paths*. One could also consider</span></span><br><span class="line"><span class="string">    *edge paths*. There is a bijection between node paths and edge</span></span><br><span class="line"><span class="string">    paths.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The *length of a path* is the number of edges in the path, so a list</span></span><br><span class="line"><span class="string">    of nodes of length *n* corresponds to a path of length *n* - 1.</span></span><br><span class="line"><span class="string">    Thus the smallest edge path would be a list of zero edges, the empty</span></span><br><span class="line"><span class="string">    path. This corresponds to a list of one node.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    To convert between a node path and an edge path, you can use code</span></span><br><span class="line"><span class="string">    like the following::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; from networkx.utils import pairwise</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; nodes = [0, 1, 2, 3]</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; edges = list(pairwise(nodes))</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; edges</span></span><br><span class="line"><span class="string">        [(0, 1), (1, 2), (2, 3)]</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; nodes = [edges[0][0]] + [v for u, v in edges]</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; nodes</span></span><br><span class="line"><span class="string">        [0, 1, 2, 3]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Examples</span></span><br><span class="line"><span class="string">    --------</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; G = nx.cycle_graph(4)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; nx.is_simple_path(G, [2, 3, 0])</span></span><br><span class="line"><span class="string">    True</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; nx.is_simple_path(G, [0, 2])</span></span><br><span class="line"><span class="string">    False</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># The empty list is not a valid path. Could also return</span></span><br><span class="line">    <span class="comment"># NetworkXPointlessConcept here.</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(nodes) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="comment"># If the list is a single node, just check that the node is actually</span></span><br><span class="line">    <span class="comment"># in the graph.</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(nodes) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> nodes[<span class="number">0</span>] <span class="keyword">in</span> G</span><br><span class="line">    <span class="comment"># Test that no node appears more than once, and that each</span></span><br><span class="line">    <span class="comment"># adjacent pair of nodes is adjacent.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(<span class="built_in">set</span>(nodes)) == <span class="built_in">len</span>(nodes) <span class="keyword">and</span> <span class="built_in">all</span>(v <span class="keyword">in</span> G[u] <span class="keyword">for</span> u, v <span class="keyword">in</span> pairwise(nodes))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">all_simple_paths</span>(<span class="params">G, source, target, cutoff=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Generate all simple paths in the graph G from source to target.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    A simple path is a path with no repeated nodes.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    G : NetworkX graph</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    source : node</span></span><br><span class="line"><span class="string">       Starting node for path</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    target : nodes</span></span><br><span class="line"><span class="string">       Single node or iterable of nodes at which to end path</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    cutoff : integer, optional</span></span><br><span class="line"><span class="string">        Depth to stop the search. Only paths of length &lt;= cutoff are returned.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns</span></span><br><span class="line"><span class="string">    -------</span></span><br><span class="line"><span class="string">    path_generator: generator</span></span><br><span class="line"><span class="string">       A generator that produces lists of simple paths.  If there are no paths</span></span><br><span class="line"><span class="string">       between the source and target within the given cutoff the generator</span></span><br><span class="line"><span class="string">       produces no output.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Examples</span></span><br><span class="line"><span class="string">    --------</span></span><br><span class="line"><span class="string">    This iterator generates lists of nodes::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; G = nx.complete_graph(4)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; for path in nx.all_simple_paths(G, source=0, target=3):</span></span><br><span class="line"><span class="string">        ...     print(path)</span></span><br><span class="line"><span class="string">        ...</span></span><br><span class="line"><span class="string">        [0, 1, 2, 3]</span></span><br><span class="line"><span class="string">        [0, 1, 3]</span></span><br><span class="line"><span class="string">        [0, 2, 1, 3]</span></span><br><span class="line"><span class="string">        [0, 2, 3]</span></span><br><span class="line"><span class="string">        [0, 3]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    You can generate only those paths that are shorter than a certain</span></span><br><span class="line"><span class="string">    length by using the `cutoff` keyword argument::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; paths = nx.all_simple_paths(G, source=0, target=3, cutoff=2)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; print(list(paths))</span></span><br><span class="line"><span class="string">        [[0, 1, 3], [0, 2, 3], [0, 3]]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    To get each path as the corresponding list of edges, you can use the</span></span><br><span class="line"><span class="string">    :func:`networkx.utils.pairwise` helper function::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; paths = nx.all_simple_paths(G, source=0, target=3)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; for path in map(nx.utils.pairwise, paths):</span></span><br><span class="line"><span class="string">        ...     print(list(path))</span></span><br><span class="line"><span class="string">        [(0, 1), (1, 2), (2, 3)]</span></span><br><span class="line"><span class="string">        [(0, 1), (1, 3)]</span></span><br><span class="line"><span class="string">        [(0, 2), (2, 1), (1, 3)]</span></span><br><span class="line"><span class="string">        [(0, 2), (2, 3)]</span></span><br><span class="line"><span class="string">        [(0, 3)]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Pass an iterable of nodes as target to generate all paths ending in any of several nodes::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; G = nx.complete_graph(4)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; for path in nx.all_simple_paths(G, source=0, target=[3, 2]):</span></span><br><span class="line"><span class="string">        ...     print(path)</span></span><br><span class="line"><span class="string">        ...</span></span><br><span class="line"><span class="string">        [0, 1, 2]</span></span><br><span class="line"><span class="string">        [0, 1, 2, 3]</span></span><br><span class="line"><span class="string">        [0, 1, 3]</span></span><br><span class="line"><span class="string">        [0, 1, 3, 2]</span></span><br><span class="line"><span class="string">        [0, 2]</span></span><br><span class="line"><span class="string">        [0, 2, 1, 3]</span></span><br><span class="line"><span class="string">        [0, 2, 3]</span></span><br><span class="line"><span class="string">        [0, 3]</span></span><br><span class="line"><span class="string">        [0, 3, 1, 2]</span></span><br><span class="line"><span class="string">        [0, 3, 2]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Iterate over each path from the root nodes to the leaf nodes in a</span></span><br><span class="line"><span class="string">    directed acyclic graph using a functional programming approach::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; from itertools import chain</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; from itertools import product</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; from itertools import starmap</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; from functools import partial</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt;</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; chaini = chain.from_iterable</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt;</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; G = nx.DiGraph([(0, 1), (1, 2), (0, 3), (3, 2)])</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; roots = (v for v, d in G.in_degree() if d == 0)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; leaves = (v for v, d in G.out_degree() if d == 0)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; all_paths = partial(nx.all_simple_paths, G)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; list(chaini(starmap(all_paths, product(roots, leaves))))</span></span><br><span class="line"><span class="string">        [[0, 1, 2], [0, 3, 2]]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The same list computed using an iterative approach::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; G = nx.DiGraph([(0, 1), (1, 2), (0, 3), (3, 2)])</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; roots = (v for v, d in G.in_degree() if d == 0)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; leaves = (v for v, d in G.out_degree() if d == 0)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; all_paths = []</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; for root in roots:</span></span><br><span class="line"><span class="string">        ...     for leaf in leaves:</span></span><br><span class="line"><span class="string">        ...         paths = nx.all_simple_paths(G, root, leaf)</span></span><br><span class="line"><span class="string">        ...         all_paths.extend(paths)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; all_paths</span></span><br><span class="line"><span class="string">        [[0, 1, 2], [0, 3, 2]]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Iterate over each path from the root nodes to the leaf nodes in a</span></span><br><span class="line"><span class="string">    directed acyclic graph passing all leaves together to avoid unnecessary</span></span><br><span class="line"><span class="string">    compute::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; G = nx.DiGraph([(0, 1), (2, 1), (1, 3), (1, 4)])</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; roots = (v for v, d in G.in_degree() if d == 0)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; leaves = [v for v, d in G.out_degree() if d == 0]</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; all_paths = []</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; for root in roots:</span></span><br><span class="line"><span class="string">        ...     paths = nx.all_simple_paths(G, root, leaves)</span></span><br><span class="line"><span class="string">        ...     all_paths.extend(paths)</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; all_paths</span></span><br><span class="line"><span class="string">        [[0, 1, 3], [0, 1, 4], [2, 1, 3], [2, 1, 4]]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Notes</span></span><br><span class="line"><span class="string">    -----</span></span><br><span class="line"><span class="string">    This algorithm uses a modified depth-first search to generate the</span></span><br><span class="line"><span class="string">    paths [1]_.  A single path can be found in $O(V+E)$ time but the</span></span><br><span class="line"><span class="string">    number of simple paths in a graph can be very large, e.g. $O(n!)$ in</span></span><br><span class="line"><span class="string">    the complete graph of order $n$.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    References</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    .. [1] R. Sedgewick, &quot;Algorithms in C, Part 5: Graph Algorithms&quot;,</span></span><br><span class="line"><span class="string">       Addison Wesley Professional, 3rd ed., 2001.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    See Also</span></span><br><span class="line"><span class="string">    --------</span></span><br><span class="line"><span class="string">    all_shortest_paths, shortest_path</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> source <span class="keyword">not</span> <span class="keyword">in</span> G:</span><br><span class="line">        <span class="keyword">raise</span> nx.NodeNotFound(<span class="string">f&quot;source node <span class="subst">&#123;source&#125;</span> not in graph&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> target <span class="keyword">in</span> G:</span><br><span class="line">        targets = &#123;target&#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            targets = <span class="built_in">set</span>(target)</span><br><span class="line">        <span class="keyword">except</span> TypeError <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> nx.NodeNotFound(<span class="string">f&quot;target node <span class="subst">&#123;target&#125;</span> not in graph&quot;</span>) <span class="keyword">from</span> e</span><br><span class="line">    <span class="keyword">if</span> source <span class="keyword">in</span> targets:</span><br><span class="line">        <span class="keyword">return</span> empty_generator()</span><br><span class="line">    <span class="keyword">if</span> cutoff <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        cutoff = <span class="built_in">len</span>(G) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> cutoff &lt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> empty_generator()</span><br><span class="line">    <span class="keyword">if</span> G.is_multigraph():</span><br><span class="line">        <span class="keyword">return</span> _all_simple_paths_multigraph(G, source, targets, cutoff)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> _all_simple_paths_graph(G, source, targets, cutoff)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_all_simple_paths_graph</span>(<span class="params">G, source, targets, cutoff</span>):</span><br><span class="line">    visited = <span class="built_in">dict</span>.fromkeys([source])</span><br><span class="line">    stack = [<span class="built_in">iter</span>(G[source])]</span><br><span class="line">    <span class="keyword">while</span> stack:</span><br><span class="line">        children = stack[-<span class="number">1</span>]</span><br><span class="line">        child = <span class="built_in">next</span>(children, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> child <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            stack.pop()</span><br><span class="line">            visited.popitem()</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(visited) &lt; cutoff:</span><br><span class="line">            <span class="keyword">if</span> child <span class="keyword">in</span> visited:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> child <span class="keyword">in</span> targets:</span><br><span class="line">                <span class="keyword">yield</span> <span class="built_in">list</span>(visited) + [child]</span><br><span class="line">            visited[child] = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">if</span> targets - <span class="built_in">set</span>(visited.keys()):  <span class="comment"># expand stack until find all targets</span></span><br><span class="line">                stack.append(<span class="built_in">iter</span>(G[child]))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                visited.popitem()  <span class="comment"># maybe other ways to child</span></span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># len(visited) == cutoff:</span></span><br><span class="line">            <span class="keyword">for</span> target <span class="keyword">in</span> (targets &amp; (<span class="built_in">set</span>(children) | &#123;child&#125;)) - <span class="built_in">set</span>(visited.keys()):</span><br><span class="line">                <span class="keyword">yield</span> <span class="built_in">list</span>(visited) + [target]</span><br><span class="line">            stack.pop()</span><br><span class="line">            visited.popitem()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_all_simple_paths_multigraph</span>(<span class="params">G, source, targets, cutoff</span>):</span><br><span class="line">    visited = <span class="built_in">dict</span>.fromkeys([source])</span><br><span class="line">    stack = [(v <span class="keyword">for</span> u, v <span class="keyword">in</span> G.edges(source))]</span><br><span class="line">    <span class="keyword">while</span> stack:</span><br><span class="line">        children = stack[-<span class="number">1</span>]</span><br><span class="line">        child = <span class="built_in">next</span>(children, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> child <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            stack.pop()</span><br><span class="line">            visited.popitem()</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(visited) &lt; cutoff:</span><br><span class="line">            <span class="keyword">if</span> child <span class="keyword">in</span> visited:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> child <span class="keyword">in</span> targets:</span><br><span class="line">                <span class="keyword">yield</span> <span class="built_in">list</span>(visited) + [child]</span><br><span class="line">            visited[child] = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">if</span> targets - <span class="built_in">set</span>(visited.keys()):</span><br><span class="line">                stack.append((v <span class="keyword">for</span> u, v <span class="keyword">in</span> G.edges(child)))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                visited.popitem()</span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># len(visited) == cutoff:</span></span><br><span class="line">            <span class="keyword">for</span> target <span class="keyword">in</span> targets - <span class="built_in">set</span>(visited.keys()):</span><br><span class="line">                count = ([child] + <span class="built_in">list</span>(children)).count(target)</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">                    <span class="keyword">yield</span> <span class="built_in">list</span>(visited) + [target]</span><br><span class="line">            stack.pop()</span><br><span class="line">            visited.popitem()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">all_simple_edge_paths</span>(<span class="params">G, source, target, cutoff=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Generate lists of edges for all simple paths in G from source to target.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    A simple path is a path with no repeated nodes.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    G : NetworkX graph</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    source : node</span></span><br><span class="line"><span class="string">       Starting node for path</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    target : nodes</span></span><br><span class="line"><span class="string">       Single node or iterable of nodes at which to end path</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    cutoff : integer, optional</span></span><br><span class="line"><span class="string">        Depth to stop the search. Only paths of length &lt;= cutoff are returned.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns</span></span><br><span class="line"><span class="string">    -------</span></span><br><span class="line"><span class="string">    path_generator: generator</span></span><br><span class="line"><span class="string">       A generator that produces lists of simple paths.  If there are no paths</span></span><br><span class="line"><span class="string">       between the source and target within the given cutoff the generator</span></span><br><span class="line"><span class="string">       produces no output.</span></span><br><span class="line"><span class="string">       For multigraphs, the list of edges have elements of the form `(u,v,k)`.</span></span><br><span class="line"><span class="string">       Where `k` corresponds to the edge key.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Examples</span></span><br><span class="line"><span class="string">    --------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Print the simple path edges of a Graph::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; g = nx.Graph([(1, 2), (2, 4), (1, 3), (3, 4)])</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; for path in sorted(nx.all_simple_edge_paths(g, 1, 4)):</span></span><br><span class="line"><span class="string">        ...     print(path)</span></span><br><span class="line"><span class="string">        [(1, 2), (2, 4)]</span></span><br><span class="line"><span class="string">        [(1, 3), (3, 4)]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Print the simple path edges of a MultiGraph. Returned edges come with</span></span><br><span class="line"><span class="string">    their associated keys::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; mg = nx.MultiGraph()</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; mg.add_edge(1, 2, key=&quot;k0&quot;)</span></span><br><span class="line"><span class="string">        &#x27;k0&#x27;</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; mg.add_edge(1, 2, key=&quot;k1&quot;)</span></span><br><span class="line"><span class="string">        &#x27;k1&#x27;</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; mg.add_edge(2, 3, key=&quot;k0&quot;)</span></span><br><span class="line"><span class="string">        &#x27;k0&#x27;</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; for path in sorted(nx.all_simple_edge_paths(mg, 1, 3)):</span></span><br><span class="line"><span class="string">        ...     print(path)</span></span><br><span class="line"><span class="string">        [(1, 2, &#x27;k0&#x27;), (2, 3, &#x27;k0&#x27;)]</span></span><br><span class="line"><span class="string">        [(1, 2, &#x27;k1&#x27;), (2, 3, &#x27;k0&#x27;)]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Notes</span></span><br><span class="line"><span class="string">    -----</span></span><br><span class="line"><span class="string">    This algorithm uses a modified depth-first search to generate the</span></span><br><span class="line"><span class="string">    paths [1]_.  A single path can be found in $O(V+E)$ time but the</span></span><br><span class="line"><span class="string">    number of simple paths in a graph can be very large, e.g. $O(n!)$ in</span></span><br><span class="line"><span class="string">    the complete graph of order $n$.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    References</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    .. [1] R. Sedgewick, &quot;Algorithms in C, Part 5: Graph Algorithms&quot;,</span></span><br><span class="line"><span class="string">       Addison Wesley Professional, 3rd ed., 2001.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    See Also</span></span><br><span class="line"><span class="string">    --------</span></span><br><span class="line"><span class="string">    all_shortest_paths, shortest_path, all_simple_paths</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> source <span class="keyword">not</span> <span class="keyword">in</span> G:</span><br><span class="line">        <span class="keyword">raise</span> nx.NodeNotFound(<span class="string">&quot;source node %s not in graph&quot;</span> % source)</span><br><span class="line">    <span class="keyword">if</span> target <span class="keyword">in</span> G:</span><br><span class="line">        targets = &#123;target&#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            targets = <span class="built_in">set</span>(target)</span><br><span class="line">        <span class="keyword">except</span> TypeError:</span><br><span class="line">            <span class="keyword">raise</span> nx.NodeNotFound(<span class="string">&quot;target node %s not in graph&quot;</span> % target)</span><br><span class="line">    <span class="keyword">if</span> source <span class="keyword">in</span> targets:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">if</span> cutoff <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        cutoff = <span class="built_in">len</span>(G) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> cutoff &lt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">if</span> G.is_multigraph():</span><br><span class="line">        <span class="keyword">for</span> simp_path <span class="keyword">in</span> _all_simple_edge_paths_multigraph(G, source, targets, cutoff):</span><br><span class="line">            <span class="keyword">yield</span> simp_path</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> simp_path <span class="keyword">in</span> _all_simple_paths_graph(G, source, targets, cutoff):</span><br><span class="line">            <span class="keyword">yield</span> <span class="built_in">list</span>(<span class="built_in">zip</span>(simp_path[:-<span class="number">1</span>], simp_path[<span class="number">1</span>:]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_all_simple_edge_paths_multigraph</span>(<span class="params">G, source, targets, cutoff</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> cutoff <span class="keyword">or</span> cutoff &lt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    visited = [source]</span><br><span class="line">    stack = [<span class="built_in">iter</span>(G.edges(source, keys=<span class="literal">True</span>))]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> stack:</span><br><span class="line">        children = stack[-<span class="number">1</span>]</span><br><span class="line">        child = <span class="built_in">next</span>(children, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> child <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            stack.pop()</span><br><span class="line">            visited.pop()</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(visited) &lt; cutoff:</span><br><span class="line">            <span class="keyword">if</span> child[<span class="number">1</span>] <span class="keyword">in</span> targets:</span><br><span class="line">                <span class="keyword">yield</span> visited[<span class="number">1</span>:] + [child]</span><br><span class="line">            <span class="keyword">elif</span> child[<span class="number">1</span>] <span class="keyword">not</span> <span class="keyword">in</span> [v[<span class="number">0</span>] <span class="keyword">for</span> v <span class="keyword">in</span> visited[<span class="number">1</span>:]]:</span><br><span class="line">                visited.append(child)</span><br><span class="line">                stack.append(<span class="built_in">iter</span>(G.edges(child[<span class="number">1</span>], keys=<span class="literal">True</span>)))</span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># len(visited) == cutoff:</span></span><br><span class="line">            <span class="keyword">for</span> (u, v, k) <span class="keyword">in</span> [child] + <span class="built_in">list</span>(children):</span><br><span class="line">                <span class="keyword">if</span> v <span class="keyword">in</span> targets:</span><br><span class="line">                    <span class="keyword">yield</span> visited[<span class="number">1</span>:] + [(u, v, k)]</span><br><span class="line">            stack.pop()</span><br><span class="line">            visited.pop()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@not_implemented_for(<span class="params"><span class="string">&quot;multigraph&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shortest_simple_paths</span>(<span class="params">G, source, target, weight=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Generate all simple paths in the graph G from source to target,</span></span><br><span class="line"><span class="string">       starting from shortest ones.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    A simple path is a path with no repeated nodes.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    If a weighted shortest path search is to be used, no negative weights</span></span><br><span class="line"><span class="string">    are allowed.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    G : NetworkX graph</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    source : node</span></span><br><span class="line"><span class="string">       Starting node for path</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    target : node</span></span><br><span class="line"><span class="string">       Ending node for path</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    weight : string or function</span></span><br><span class="line"><span class="string">        If it is a string, it is the name of the edge attribute to be</span></span><br><span class="line"><span class="string">        used as a weight.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        If it is a function, the weight of an edge is the value returned</span></span><br><span class="line"><span class="string">        by the function. The function must accept exactly three positional</span></span><br><span class="line"><span class="string">        arguments: the two endpoints of an edge and the dictionary of edge</span></span><br><span class="line"><span class="string">        attributes for that edge. The function must return a number.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        If None all edges are considered to have unit weight. Default</span></span><br><span class="line"><span class="string">        value None.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns</span></span><br><span class="line"><span class="string">    -------</span></span><br><span class="line"><span class="string">    path_generator: generator</span></span><br><span class="line"><span class="string">       A generator that produces lists of simple paths, in order from</span></span><br><span class="line"><span class="string">       shortest to longest.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Raises</span></span><br><span class="line"><span class="string">    ------</span></span><br><span class="line"><span class="string">    NetworkXNoPath</span></span><br><span class="line"><span class="string">       If no path exists between source and target.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    NetworkXError</span></span><br><span class="line"><span class="string">       If source or target nodes are not in the input graph.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    NetworkXNotImplemented</span></span><br><span class="line"><span class="string">       If the input graph is a Multi[Di]Graph.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Examples</span></span><br><span class="line"><span class="string">    --------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; G = nx.cycle_graph(7)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; paths = list(nx.shortest_simple_paths(G, 0, 3))</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; print(paths)</span></span><br><span class="line"><span class="string">    [[0, 1, 2, 3], [0, 6, 5, 4, 3]]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    You can use this function to efficiently compute the k shortest/best</span></span><br><span class="line"><span class="string">    paths between two nodes.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; from itertools import islice</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; def k_shortest_paths(G, source, target, k, weight=None):</span></span><br><span class="line"><span class="string">    ...     return list(</span></span><br><span class="line"><span class="string">    ...         islice(nx.shortest_simple_paths(G, source, target, weight=weight), k)</span></span><br><span class="line"><span class="string">    ...     )</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; for path in k_shortest_paths(G, 0, 3, 2):</span></span><br><span class="line"><span class="string">    ...     print(path)</span></span><br><span class="line"><span class="string">    [0, 1, 2, 3]</span></span><br><span class="line"><span class="string">    [0, 6, 5, 4, 3]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Notes</span></span><br><span class="line"><span class="string">    -----</span></span><br><span class="line"><span class="string">    This procedure is based on algorithm by Jin Y. Yen [1]_.  Finding</span></span><br><span class="line"><span class="string">    the first $K$ paths requires $O(KN^3)$ operations.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    See Also</span></span><br><span class="line"><span class="string">    --------</span></span><br><span class="line"><span class="string">    all_shortest_paths</span></span><br><span class="line"><span class="string">    shortest_path</span></span><br><span class="line"><span class="string">    all_simple_paths</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    References</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    .. [1] Jin Y. Yen, &quot;Finding the K Shortest Loopless Paths in a</span></span><br><span class="line"><span class="string">       Network&quot;, Management Science, Vol. 17, No. 11, Theory Series</span></span><br><span class="line"><span class="string">       (Jul., 1971), pp. 712-716.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> source <span class="keyword">not</span> <span class="keyword">in</span> G:</span><br><span class="line">        <span class="comment">#raise nx.NodeNotFound(f&quot;source node &#123;source&#125; not in graph&quot;)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> target <span class="keyword">not</span> <span class="keyword">in</span> G:</span><br><span class="line">        <span class="comment">#raise nx.NodeNotFound(f&quot;target node &#123;target&#125; not in graph&quot;)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> weight <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        length_func = <span class="built_in">len</span></span><br><span class="line">        shortest_path_func = _bidirectional_shortest_path</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        wt = _weight_function(G, weight)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">length_func</span>(<span class="params">path</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">sum</span>(</span><br><span class="line">                wt(u, v, G.get_edge_data(u, v)) <span class="keyword">for</span> (u, v) <span class="keyword">in</span> <span class="built_in">zip</span>(path, path[<span class="number">1</span>:])</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">        shortest_path_func = _bidirectional_dijkstra</span><br><span class="line"></span><br><span class="line">    listA = <span class="built_in">list</span>()</span><br><span class="line">    listB = PathBuffer()</span><br><span class="line">    prev_path = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> prev_path:</span><br><span class="line">            length, path = shortest_path_func(G, source, target, weight=weight)</span><br><span class="line">            <span class="keyword">if</span> path <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            listB.push(length, path)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ignore_nodes = <span class="built_in">set</span>()</span><br><span class="line">            ignore_edges = <span class="built_in">set</span>()</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(prev_path)):</span><br><span class="line">                root = prev_path[:i]</span><br><span class="line">                root_length = length_func(root)</span><br><span class="line">                <span class="keyword">for</span> path <span class="keyword">in</span> listA:</span><br><span class="line">                    <span class="keyword">if</span> path[:i] == root:</span><br><span class="line">                        ignore_edges.add((path[i - <span class="number">1</span>], path[i]))</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    length, spur = shortest_path_func(</span><br><span class="line">                        G,</span><br><span class="line">                        root[-<span class="number">1</span>],</span><br><span class="line">                        target,</span><br><span class="line">                        ignore_nodes=ignore_nodes,</span><br><span class="line">                        ignore_edges=ignore_edges,</span><br><span class="line">                        weight=weight,</span><br><span class="line">                    )</span><br><span class="line">                    <span class="keyword">if</span> spur <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">                    path = root[:-<span class="number">1</span>] + spur</span><br><span class="line">                    listB.push(root_length + length, path)</span><br><span class="line">                <span class="keyword">except</span> nx.NetworkXNoPath:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">                ignore_nodes.add(root[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> listB:</span><br><span class="line">            path = listB.pop()</span><br><span class="line">            <span class="keyword">yield</span> path</span><br><span class="line">            listA.append(path)</span><br><span class="line">            prev_path = path</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PathBuffer</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.paths = <span class="built_in">set</span>()</span><br><span class="line">        self.sortedpaths = <span class="built_in">list</span>()</span><br><span class="line">        self.counter = count()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.sortedpaths)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">push</span>(<span class="params">self, cost, path</span>):</span><br><span class="line">        hashable_path = <span class="built_in">tuple</span>(path)</span><br><span class="line">        <span class="keyword">if</span> hashable_path <span class="keyword">not</span> <span class="keyword">in</span> self.paths:</span><br><span class="line">            heappush(self.sortedpaths, (cost, <span class="built_in">next</span>(self.counter), path))</span><br><span class="line">            self.paths.add(hashable_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pop</span>(<span class="params">self</span>):</span><br><span class="line">        (cost, num, path) = heappop(self.sortedpaths)</span><br><span class="line">        hashable_path = <span class="built_in">tuple</span>(path)</span><br><span class="line">        self.paths.remove(hashable_path)</span><br><span class="line">        <span class="keyword">return</span> path</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_bidirectional_shortest_path</span>(<span class="params"></span></span><br><span class="line"><span class="params">    G, source, target, ignore_nodes=<span class="literal">None</span>, ignore_edges=<span class="literal">None</span>, weight=<span class="literal">None</span></span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns the shortest path between source and target ignoring</span></span><br><span class="line"><span class="string">       nodes and edges in the containers ignore_nodes and ignore_edges.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This is a custom modification of the standard bidirectional shortest</span></span><br><span class="line"><span class="string">    path implementation at networkx.algorithms.unweighted</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    G : NetworkX graph</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    source : node</span></span><br><span class="line"><span class="string">       starting node for path</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    target : node</span></span><br><span class="line"><span class="string">       ending node for path</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ignore_nodes : container of nodes</span></span><br><span class="line"><span class="string">       nodes to ignore, optional</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ignore_edges : container of edges</span></span><br><span class="line"><span class="string">       edges to ignore, optional</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    weight : None</span></span><br><span class="line"><span class="string">       This function accepts a weight argument for convenience of</span></span><br><span class="line"><span class="string">       shortest_simple_paths function. It will be ignored.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns</span></span><br><span class="line"><span class="string">    -------</span></span><br><span class="line"><span class="string">    path: list</span></span><br><span class="line"><span class="string">       List of nodes in a path from source to target.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Raises</span></span><br><span class="line"><span class="string">    ------</span></span><br><span class="line"><span class="string">    NetworkXNoPath</span></span><br><span class="line"><span class="string">       If no path exists between source and target.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    See Also</span></span><br><span class="line"><span class="string">    --------</span></span><br><span class="line"><span class="string">    shortest_path</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># call helper to do the real work</span></span><br><span class="line">    results = _bidirectional_pred_succ(G, source, target, ignore_nodes, ignore_edges)</span><br><span class="line">    pred, succ, w = results</span><br><span class="line"></span><br><span class="line">    <span class="comment"># build path from pred+w+succ</span></span><br><span class="line">    path = []</span><br><span class="line">    <span class="comment"># from w to target</span></span><br><span class="line">    <span class="keyword">while</span> w <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        path.append(w)</span><br><span class="line">        w = succ[w]</span><br><span class="line">    <span class="comment"># from source to w</span></span><br><span class="line">    w = pred[path[<span class="number">0</span>]]</span><br><span class="line">    <span class="keyword">while</span> w <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        path.insert(<span class="number">0</span>, w)</span><br><span class="line">        w = pred[w]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(path), path</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_bidirectional_pred_succ</span>(<span class="params">G, source, target, ignore_nodes=<span class="literal">None</span>, ignore_edges=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Bidirectional shortest path helper.</span></span><br><span class="line"><span class="string">       Returns (pred,succ,w) where</span></span><br><span class="line"><span class="string">       pred is a dictionary of predecessors from w to the source, and</span></span><br><span class="line"><span class="string">       succ is a dictionary of successors from w to the target.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># does BFS from both source and target and meets in the middle</span></span><br><span class="line">    <span class="keyword">if</span> ignore_nodes <span class="keyword">and</span> (source <span class="keyword">in</span> ignore_nodes <span class="keyword">or</span> target <span class="keyword">in</span> ignore_nodes):</span><br><span class="line">        <span class="keyword">raise</span> nx.NetworkXNoPath(<span class="string">f&quot;No path between <span class="subst">&#123;source&#125;</span> and <span class="subst">&#123;target&#125;</span>.&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> target == source:</span><br><span class="line">        <span class="keyword">return</span> (&#123;target: <span class="literal">None</span>&#125;, &#123;source: <span class="literal">None</span>&#125;, source)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># handle either directed or undirected</span></span><br><span class="line">    <span class="keyword">if</span> G.is_directed():</span><br><span class="line">        Gpred = G.predecessors</span><br><span class="line">        Gsucc = G.successors</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        Gpred = G.neighbors</span><br><span class="line">        Gsucc = G.neighbors</span><br><span class="line"></span><br><span class="line">    <span class="comment"># support optional nodes filter</span></span><br><span class="line">    <span class="keyword">if</span> ignore_nodes:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">filter_iter</span>(<span class="params">nodes</span>):</span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">iterate</span>(<span class="params">v</span>):</span><br><span class="line">                <span class="keyword">for</span> w <span class="keyword">in</span> nodes(v):</span><br><span class="line">                    <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> ignore_nodes:</span><br><span class="line">                        <span class="keyword">yield</span> w</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> iterate</span><br><span class="line"></span><br><span class="line">        Gpred = filter_iter(Gpred)</span><br><span class="line">        Gsucc = filter_iter(Gsucc)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># support optional edges filter</span></span><br><span class="line">    <span class="keyword">if</span> ignore_edges:</span><br><span class="line">        <span class="keyword">if</span> G.is_directed():</span><br><span class="line"></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">filter_pred_iter</span>(<span class="params">pred_iter</span>):</span><br><span class="line">                <span class="keyword">def</span> <span class="title function_">iterate</span>(<span class="params">v</span>):</span><br><span class="line">                    <span class="keyword">for</span> w <span class="keyword">in</span> pred_iter(v):</span><br><span class="line">                        <span class="keyword">if</span> (w, v) <span class="keyword">not</span> <span class="keyword">in</span> ignore_edges:</span><br><span class="line">                            <span class="keyword">yield</span> w</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> iterate</span><br><span class="line"></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">filter_succ_iter</span>(<span class="params">succ_iter</span>):</span><br><span class="line">                <span class="keyword">def</span> <span class="title function_">iterate</span>(<span class="params">v</span>):</span><br><span class="line">                    <span class="keyword">for</span> w <span class="keyword">in</span> succ_iter(v):</span><br><span class="line">                        <span class="keyword">if</span> (v, w) <span class="keyword">not</span> <span class="keyword">in</span> ignore_edges:</span><br><span class="line">                            <span class="keyword">yield</span> w</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> iterate</span><br><span class="line"></span><br><span class="line">            Gpred = filter_pred_iter(Gpred)</span><br><span class="line">            Gsucc = filter_succ_iter(Gsucc)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">filter_iter</span>(<span class="params">nodes</span>):</span><br><span class="line">                <span class="keyword">def</span> <span class="title function_">iterate</span>(<span class="params">v</span>):</span><br><span class="line">                    <span class="keyword">for</span> w <span class="keyword">in</span> nodes(v):</span><br><span class="line">                        <span class="keyword">if</span> (v, w) <span class="keyword">not</span> <span class="keyword">in</span> ignore_edges <span class="keyword">and</span> (w, v) <span class="keyword">not</span> <span class="keyword">in</span> ignore_edges:</span><br><span class="line">                            <span class="keyword">yield</span> w</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> iterate</span><br><span class="line"></span><br><span class="line">            Gpred = filter_iter(Gpred)</span><br><span class="line">            Gsucc = filter_iter(Gsucc)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># predecesssor and successors in search</span></span><br><span class="line">    pred = &#123;source: <span class="literal">None</span>&#125;</span><br><span class="line">    succ = &#123;target: <span class="literal">None</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># initialize fringes, start with forward</span></span><br><span class="line">    forward_fringe = [source]</span><br><span class="line">    reverse_fringe = [target]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> forward_fringe <span class="keyword">and</span> reverse_fringe:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(forward_fringe) &lt;= <span class="built_in">len</span>(reverse_fringe):</span><br><span class="line">            this_level = forward_fringe</span><br><span class="line">            forward_fringe = []</span><br><span class="line">            <span class="keyword">for</span> v <span class="keyword">in</span> this_level:</span><br><span class="line">                <span class="keyword">for</span> w <span class="keyword">in</span> Gsucc(v):</span><br><span class="line">                    <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> pred:</span><br><span class="line">                        forward_fringe.append(w)</span><br><span class="line">                        pred[w] = v</span><br><span class="line">                    <span class="keyword">if</span> w <span class="keyword">in</span> succ:</span><br><span class="line">                        <span class="comment"># found path</span></span><br><span class="line">                        <span class="keyword">return</span> pred, succ, w</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            this_level = reverse_fringe</span><br><span class="line">            reverse_fringe = []</span><br><span class="line">            <span class="keyword">for</span> v <span class="keyword">in</span> this_level:</span><br><span class="line">                <span class="keyword">for</span> w <span class="keyword">in</span> Gpred(v):</span><br><span class="line">                    <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> succ:</span><br><span class="line">                        succ[w] = v</span><br><span class="line">                        reverse_fringe.append(w)</span><br><span class="line">                    <span class="keyword">if</span> w <span class="keyword">in</span> pred:</span><br><span class="line">                        <span class="comment"># found path</span></span><br><span class="line">                        <span class="keyword">return</span> pred, succ, w</span><br><span class="line"></span><br><span class="line">    <span class="keyword">raise</span> nx.NetworkXNoPath(<span class="string">f&quot;No path between <span class="subst">&#123;source&#125;</span> and <span class="subst">&#123;target&#125;</span>.&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_bidirectional_dijkstra</span>(<span class="params"></span></span><br><span class="line"><span class="params">    G, source, target, weight=<span class="string">&quot;weight&quot;</span>, ignore_nodes=<span class="literal">None</span>, ignore_edges=<span class="literal">None</span></span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Dijkstra&#x27;s algorithm for shortest paths using bidirectional search.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This function returns the shortest path between source and target</span></span><br><span class="line"><span class="string">    ignoring nodes and edges in the containers ignore_nodes and</span></span><br><span class="line"><span class="string">    ignore_edges.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This is a custom modification of the standard Dijkstra bidirectional</span></span><br><span class="line"><span class="string">    shortest path implementation at networkx.algorithms.weighted</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    G : NetworkX graph</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    source : node</span></span><br><span class="line"><span class="string">       Starting node.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    target : node</span></span><br><span class="line"><span class="string">       Ending node.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    weight: string, function, optional (default=&#x27;weight&#x27;)</span></span><br><span class="line"><span class="string">       Edge data key or weight function corresponding to the edge weight</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ignore_nodes : container of nodes</span></span><br><span class="line"><span class="string">       nodes to ignore, optional</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ignore_edges : container of edges</span></span><br><span class="line"><span class="string">       edges to ignore, optional</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns</span></span><br><span class="line"><span class="string">    -------</span></span><br><span class="line"><span class="string">    length : number</span></span><br><span class="line"><span class="string">        Shortest path length.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns a tuple of two dictionaries keyed by node.</span></span><br><span class="line"><span class="string">    The first dictionary stores distance from the source.</span></span><br><span class="line"><span class="string">    The second stores the path from the source to that node.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Raises</span></span><br><span class="line"><span class="string">    ------</span></span><br><span class="line"><span class="string">    NetworkXNoPath</span></span><br><span class="line"><span class="string">        If no path exists between source and target.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Notes</span></span><br><span class="line"><span class="string">    -----</span></span><br><span class="line"><span class="string">    Edge weight attributes must be numerical.</span></span><br><span class="line"><span class="string">    Distances are calculated as sums of weighted edges traversed.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    In practice  bidirectional Dijkstra is much more than twice as fast as</span></span><br><span class="line"><span class="string">    ordinary Dijkstra.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Ordinary Dijkstra expands nodes in a sphere-like manner from the</span></span><br><span class="line"><span class="string">    source. The radius of this sphere will eventually be the length</span></span><br><span class="line"><span class="string">    of the shortest path. Bidirectional Dijkstra will expand nodes</span></span><br><span class="line"><span class="string">    from both the source and the target, making two spheres of half</span></span><br><span class="line"><span class="string">    this radius. Volume of the first sphere is pi*r*r while the</span></span><br><span class="line"><span class="string">    others are 2*pi*r/2*r/2, making up half the volume.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This algorithm is not guaranteed to work if edge weights</span></span><br><span class="line"><span class="string">    are negative or are floating point numbers</span></span><br><span class="line"><span class="string">    (overflows and roundoff errors can cause problems).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    See Also</span></span><br><span class="line"><span class="string">    --------</span></span><br><span class="line"><span class="string">    shortest_path</span></span><br><span class="line"><span class="string">    shortest_path_length</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> ignore_nodes <span class="keyword">and</span> (source <span class="keyword">in</span> ignore_nodes <span class="keyword">or</span> target <span class="keyword">in</span> ignore_nodes):</span><br><span class="line">        <span class="keyword">raise</span> nx.NetworkXNoPath(<span class="string">f&quot;No path between <span class="subst">&#123;source&#125;</span> and <span class="subst">&#123;target&#125;</span>.&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> source == target:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">0</span>, [source])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># handle either directed or undirected</span></span><br><span class="line">    <span class="keyword">if</span> G.is_directed():</span><br><span class="line">        Gpred = G.predecessors</span><br><span class="line">        Gsucc = G.successors</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        Gpred = G.neighbors</span><br><span class="line">        Gsucc = G.neighbors</span><br><span class="line"></span><br><span class="line">    <span class="comment"># support optional nodes filter</span></span><br><span class="line">    <span class="keyword">if</span> ignore_nodes:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">filter_iter</span>(<span class="params">nodes</span>):</span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">iterate</span>(<span class="params">v</span>):</span><br><span class="line">                <span class="keyword">for</span> w <span class="keyword">in</span> nodes(v):</span><br><span class="line">                    <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> ignore_nodes:</span><br><span class="line">                        <span class="keyword">yield</span> w</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> iterate</span><br><span class="line"></span><br><span class="line">        Gpred = filter_iter(Gpred)</span><br><span class="line">        Gsucc = filter_iter(Gsucc)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># support optional edges filter</span></span><br><span class="line">    <span class="keyword">if</span> ignore_edges:</span><br><span class="line">        <span class="keyword">if</span> G.is_directed():</span><br><span class="line"></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">filter_pred_iter</span>(<span class="params">pred_iter</span>):</span><br><span class="line">                <span class="keyword">def</span> <span class="title function_">iterate</span>(<span class="params">v</span>):</span><br><span class="line">                    <span class="keyword">for</span> w <span class="keyword">in</span> pred_iter(v):</span><br><span class="line">                        <span class="keyword">if</span> (w, v) <span class="keyword">not</span> <span class="keyword">in</span> ignore_edges:</span><br><span class="line">                            <span class="keyword">yield</span> w</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> iterate</span><br><span class="line"></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">filter_succ_iter</span>(<span class="params">succ_iter</span>):</span><br><span class="line">                <span class="keyword">def</span> <span class="title function_">iterate</span>(<span class="params">v</span>):</span><br><span class="line">                    <span class="keyword">for</span> w <span class="keyword">in</span> succ_iter(v):</span><br><span class="line">                        <span class="keyword">if</span> (v, w) <span class="keyword">not</span> <span class="keyword">in</span> ignore_edges:</span><br><span class="line">                            <span class="keyword">yield</span> w</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> iterate</span><br><span class="line"></span><br><span class="line">            Gpred = filter_pred_iter(Gpred)</span><br><span class="line">            Gsucc = filter_succ_iter(Gsucc)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">filter_iter</span>(<span class="params">nodes</span>):</span><br><span class="line">                <span class="keyword">def</span> <span class="title function_">iterate</span>(<span class="params">v</span>):</span><br><span class="line">                    <span class="keyword">for</span> w <span class="keyword">in</span> nodes(v):</span><br><span class="line">                        <span class="keyword">if</span> (v, w) <span class="keyword">not</span> <span class="keyword">in</span> ignore_edges <span class="keyword">and</span> (w, v) <span class="keyword">not</span> <span class="keyword">in</span> ignore_edges:</span><br><span class="line">                            <span class="keyword">yield</span> w</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> iterate</span><br><span class="line"></span><br><span class="line">            Gpred = filter_iter(Gpred)</span><br><span class="line">            Gsucc = filter_iter(Gsucc)</span><br><span class="line"></span><br><span class="line">    push = heappush</span><br><span class="line">    pop = heappop</span><br><span class="line">    <span class="comment"># Init:   Forward             Backward</span></span><br><span class="line">    dists = [&#123;&#125;, &#123;&#125;]  <span class="comment"># dictionary of final distances</span></span><br><span class="line">    paths = [&#123;source: [source]&#125;, &#123;target: [target]&#125;]  <span class="comment"># dictionary of paths</span></span><br><span class="line">    fringe = [[], []]  <span class="comment"># heap of (distance, node) tuples for</span></span><br><span class="line">    <span class="comment"># extracting next node to expand</span></span><br><span class="line">    seen = [&#123;source: <span class="number">0</span>&#125;, &#123;target: <span class="number">0</span>&#125;]  <span class="comment"># dictionary of distances to</span></span><br><span class="line">    <span class="comment"># nodes seen</span></span><br><span class="line">    c = count()</span><br><span class="line">    <span class="comment"># initialize fringe heap</span></span><br><span class="line">    push(fringe[<span class="number">0</span>], (<span class="number">0</span>, <span class="built_in">next</span>(c), source))</span><br><span class="line">    push(fringe[<span class="number">1</span>], (<span class="number">0</span>, <span class="built_in">next</span>(c), target))</span><br><span class="line">    <span class="comment"># neighs for extracting correct neighbor information</span></span><br><span class="line">    neighs = [Gsucc, Gpred]</span><br><span class="line">    <span class="comment"># variables to hold shortest discovered path</span></span><br><span class="line">    <span class="comment"># finaldist = 1e30000</span></span><br><span class="line">    finalpath = []</span><br><span class="line">    <span class="built_in">dir</span> = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> fringe[<span class="number">0</span>] <span class="keyword">and</span> fringe[<span class="number">1</span>]:</span><br><span class="line">        <span class="comment"># choose direction</span></span><br><span class="line">        <span class="comment"># dir == 0 is forward direction and dir == 1 is back</span></span><br><span class="line">        <span class="built_in">dir</span> = <span class="number">1</span> - <span class="built_in">dir</span></span><br><span class="line">        <span class="comment"># extract closest to expand</span></span><br><span class="line">        (dist, _, v) = pop(fringe[<span class="built_in">dir</span>])</span><br><span class="line">        <span class="keyword">if</span> v <span class="keyword">in</span> dists[<span class="built_in">dir</span>]:</span><br><span class="line">            <span class="comment"># Shortest path to v has already been found</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># update distance</span></span><br><span class="line">        dists[<span class="built_in">dir</span>][v] = dist  <span class="comment"># equal to seen[dir][v]</span></span><br><span class="line">        <span class="keyword">if</span> v <span class="keyword">in</span> dists[<span class="number">1</span> - <span class="built_in">dir</span>]:</span><br><span class="line">            <span class="comment"># if we have scanned v in both directions we are done</span></span><br><span class="line">            <span class="comment"># we have now discovered the shortest path</span></span><br><span class="line">            <span class="keyword">return</span> (finaldist, finalpath)</span><br><span class="line"></span><br><span class="line">        wt = _weight_function(G, weight)</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> neighs[<span class="built_in">dir</span>](v):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">dir</span> == <span class="number">0</span>:  <span class="comment"># forward</span></span><br><span class="line">                minweight = wt(v, w, G.get_edge_data(v, w))</span><br><span class="line">                vwLength = dists[<span class="built_in">dir</span>][v] + minweight</span><br><span class="line">            <span class="keyword">else</span>:  <span class="comment"># back, must remember to change v,w-&gt;w,v</span></span><br><span class="line">                minweight = wt(w, v, G.get_edge_data(w, v))</span><br><span class="line">                vwLength = dists[<span class="built_in">dir</span>][v] + minweight</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> w <span class="keyword">in</span> dists[<span class="built_in">dir</span>]:</span><br><span class="line">                <span class="keyword">if</span> vwLength &lt; dists[<span class="built_in">dir</span>][w]:</span><br><span class="line">                    <span class="keyword">raise</span> ValueError(<span class="string">&quot;Contradictory paths found: negative weights?&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> w <span class="keyword">not</span> <span class="keyword">in</span> seen[<span class="built_in">dir</span>] <span class="keyword">or</span> vwLength &lt; seen[<span class="built_in">dir</span>][w]:</span><br><span class="line">                <span class="comment"># relaxing</span></span><br><span class="line">                seen[<span class="built_in">dir</span>][w] = vwLength</span><br><span class="line">                push(fringe[<span class="built_in">dir</span>], (vwLength, <span class="built_in">next</span>(c), w))</span><br><span class="line">                paths[<span class="built_in">dir</span>][w] = paths[<span class="built_in">dir</span>][v] + [w]</span><br><span class="line">                <span class="keyword">if</span> w <span class="keyword">in</span> seen[<span class="number">0</span>] <span class="keyword">and</span> w <span class="keyword">in</span> seen[<span class="number">1</span>]:</span><br><span class="line">                    <span class="comment"># see if this path is better than than the already</span></span><br><span class="line">                    <span class="comment"># discovered shortest path</span></span><br><span class="line">                    totaldist = seen[<span class="number">0</span>][w] + seen[<span class="number">1</span>][w]</span><br><span class="line">                    <span class="keyword">if</span> finalpath == [] <span class="keyword">or</span> finaldist &gt; totaldist:</span><br><span class="line">                        finaldist = totaldist</span><br><span class="line">                        revpath = paths[<span class="number">1</span>][w][:]</span><br><span class="line">                        revpath.reverse()</span><br><span class="line">                        finalpath = paths[<span class="number">0</span>][w] + revpath[<span class="number">1</span>:]</span><br><span class="line">    <span class="comment">#raise nx.NetworkXNoPath(f&quot;No path between &#123;source&#125; and &#123;target&#125;.&quot;)</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="literal">None</span>,<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/07/%E9%80%89%E8%B7%AF/" data-id="cl77bm6q4000g2kfy4v2s1lzd" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-first" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/07/first/" class="article-date">
  <time class="dt-published" datetime="2022-06-07T06:51:01.693Z" itemprop="datePublished">2022-06-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="MarkDown基础-一级标题一个"><a href="#MarkDown基础-一级标题一个" class="headerlink" title="MarkDown基础 一级标题一个#"></a>MarkDown基础 一级标题一个#</h1><h2 id="MarkDown-二级标题两个"><a href="#MarkDown-二级标题两个" class="headerlink" title="MarkDown 二级标题两个##"></a>MarkDown 二级标题两个##</h2><p>#文字</p>
<h2 id="删除线"><a href="#删除线" class="headerlink" title="删除线"></a>删除线</h2><p><del>文字</del> 两个波浪号技师渲染成删除线的样子<br>##习题<br><em>sadadasd</em> 一个<em>斜体<br>##加粗<br><strong>jlkjkljlk</strong> 两个</em>*<br>##斜体+加粗<br><em><strong>jlkjkl</strong></em> 三个***<br>##下划线<br><u>文字</u> 快捷键 commond+u<br>##高亮<br>&#x3D;&#x3D;kk&#x3D;&#x3D; 两个等号&#x3D;&#x3D;<br>##下标<br>kk<del>j</del>前后都加波浪号<br>##上标<br>m^2^ 用^<br>##表情符号<br>control+commond+space</p>
<p>:smile</p>
<p>:100</p>
<h2 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h2><p>使用|进行分割不同单元格，使用-来分割表头和其它行</p>
<p>“””markdown</p>
<table>
<thead>
<tr>
<th align="center">name</th>
<th align="center">price</th>
</tr>
</thead>
<tbody><tr>
<td align="center">chicken</td>
<td align="center">40</td>
</tr>
<tr>
<td align="center">fish</td>
<td align="center">70</td>
</tr>
</tbody></table>
<p>“””</p>
<p>:左边左对齐，:两边中间对齐,:右边右对齐</p>
<p>commond + option + t</p>
<h2 id="如何引用"><a href="#如何引用" class="headerlink" title="如何引用"></a>如何引用</h2><blockquote>
<p>引用的文字前面打上尖括号&gt;</p>
</blockquote>
<h2 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h2><h3 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h3><ul>
<li>hahaha</li>
<li>wowowo</li>
<li>*+space hahaha</li>
</ul>
<h3 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h3><ol>
<li><p>kk</p>
</li>
<li><p>2.+space</p>
</li>
<li><p>3.+space</p>
</li>
<li><p>4.+ space</p>
</li>
</ol>
<h1 id="代码部分"><a href="#代码部分" class="headerlink" title="代码部分"></a>代码部分</h1><p>“ &#96;&#96;&#96; + language “</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<p>“ &#96; + language “</p>
<h2 id="分割线"><a href="#分割线" class="headerlink" title="分割线"></a>分割线</h2><hr>
<p>三个*</p>
<h2 id="外部跳转"><a href="#外部跳转" class="headerlink" title="外部跳转"></a>外部跳转</h2><p>中括号+提示的文字</p>
<p><a href="www.baidu.com">提示文字</a></p>
<p>按住commond+鼠标键进行点击</p>
<p>control+相应跳转也可以</p>
<h2 id="内部跳转"><a href="#内部跳转" class="headerlink" title="内部跳转"></a>内部跳转</h2><p>本文档中跳转，只能跳到标题处</p>
<p><a href="#%E6%96%87%E5%AD%97">我想跳转</a></p>
<h2 id="自动链接"><a href="#自动链接" class="headerlink" title="自动链接"></a>自动链接</h2><p>尖括号内的内容自动转化为超链接</p>
<p><a href="mailto:&#49;&#56;&#x39;&#x31;&#x31;&#x30;&#56;&#53;&#57;&#x32;&#x36;&#64;&#49;&#54;&#51;&#x2e;&#99;&#111;&#x6d;">&#49;&#56;&#x39;&#x31;&#x31;&#x30;&#56;&#53;&#57;&#x32;&#x36;&#64;&#49;&#54;&#51;&#x2e;&#99;&#111;&#x6d;</a></p>
<h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><p>!+[图片说明]+(图片地址)</p>
<p><img src="/www.baidu.com" alt="图片"></p>
<p>or commond + v  a pic</p>
<h1 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h1><h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">	A[a]--&gt;B(s)</span><br><span class="line">	B(b)--&gt;C&#123;c&#125;</span><br><span class="line">	C&gt;c]--&gt;A[a]</span><br><span class="line">	A--没有--&gt;B--&gt;C</span><br></pre></td></tr></table></figure>

<pre><code>--&gt;
---
--text--
-.-
-.-&gt;
-.text.-
-.text.-&gt;
===
==&gt;
==
==text==&gt;
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">subgraph 子图表名称</span><br><span class="line">SSS[sss] --&gt; aaa (aaa)</span><br><span class="line">End</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/07/first/" data-id="cl77bm6ps000a2kfy5nm4hg9m" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/08/24/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2022/07/25/SDN_Final/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/07/24/SDN/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/07/18/%E7%AE%80%E5%86%99/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/07/17/%E7%BA%BF%E6%80%A7%E4%BA%92%E8%A1%A5%E9%97%AE%E9%A2%98/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>